!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).HiAnalytics=t()}(this,(function(){"use strict";var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=function(e){return e&&e.Math==Math&&e},n=t("object"==typeof globalThis&&globalThis)||t("object"==typeof window&&window)||t("object"==typeof self&&self)||t("object"==typeof e&&e)||function(){return this}()||Function("return this")(),r={},i=function(e){try{return!!e()}catch(e){return!0}},o=!i((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),s=!i((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")})),a=s,c=Function.prototype.call,u=a?c.bind(c):function(){return c.apply(c,arguments)},h={},l={}.propertyIsEnumerable,f=Object.getOwnPropertyDescriptor,d=f&&!l.call({1:2},1);h.f=d?function(e){var t=f(this,e);return!!t&&t.enumerable}:l;var p,v,m=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},g=s,y=Function.prototype,w=y.call,b=g&&y.bind.bind(w,w),k=g?b:function(e){return function(){return w.apply(e,arguments)}},E=k,S=E({}.toString),O=E("".slice),T=function(e){return O(S(e),8,-1)},x=T,C=k,L=function(e){if("Function"===x(e))return C(e)},P=i,I=T,j=Object,R=L("".split),A=P((function(){return!j("z").propertyIsEnumerable(0)}))?function(e){return"String"==I(e)?R(e,""):j(e)}:j,V=function(e){return null==e},N=V,_=TypeError,D=function(e){if(N(e))throw _("Can't call method on "+e);return e},M=A,U=D,q=function(e){return M(U(e))},H="object"==typeof document&&document.all,F={all:H,IS_HTMLDDA:void 0===H&&void 0!==H},Q=F.all,B=F.IS_HTMLDDA?function(e){return"function"==typeof e||e===Q}:function(e){return"function"==typeof e},z=B,W=F.all,G=F.IS_HTMLDDA?function(e){return"object"==typeof e?null!==e:z(e)||e===W}:function(e){return"object"==typeof e?null!==e:z(e)},X=n,J=B,K=function(e){return J(e)?e:void 0},Y=function(e,t){return arguments.length<2?K(X[e]):X[e]&&X[e][t]},$=L({}.isPrototypeOf),Z=Y("navigator","userAgent")||"",ee=n,te=Z,ne=ee.process,re=ee.Deno,ie=ne&&ne.versions||re&&re.version,oe=ie&&ie.v8;oe&&(v=(p=oe.split("."))[0]>0&&p[0]<4?1:+(p[0]+p[1])),!v&&te&&(!(p=te.match(/Edge\/(\d+)/))||p[1]>=74)&&(p=te.match(/Chrome\/(\d+)/))&&(v=+p[1]);var se=v,ae=se,ce=i,ue=!!Object.getOwnPropertySymbols&&!ce((function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&ae&&ae<41})),he=ue&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,le=Y,fe=B,de=$,pe=Object,ve=he?function(e){return"symbol"==typeof e}:function(e){var t=le("Symbol");return fe(t)&&de(t.prototype,pe(e))},me=String,ge=function(e){try{return me(e)}catch(e){return"Object"}},ye=B,we=ge,be=TypeError,ke=function(e){if(ye(e))return e;throw be(we(e)+" is not a function")},Ee=ke,Se=V,Oe=function(e,t){var n=e[t];return Se(n)?void 0:Ee(n)},Te=u,xe=B,Ce=G,Le=TypeError,Pe={exports:{}},Ie=n,je=Object.defineProperty,Re=function(e,t){try{je(Ie,e,{value:t,configurable:!0,writable:!0})}catch(n){Ie[e]=t}return t},Ae=Re,Ve="__core-js_shared__",Ne=n[Ve]||Ae(Ve,{}),_e=Ne;(Pe.exports=function(e,t){return _e[e]||(_e[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.26.0",mode:"global",copyright:"© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.26.0/LICENSE",source:"https://github.com/zloirock/core-js"});var De=D,Me=Object,Ue=function(e){return Me(De(e))},qe=Ue,He=L({}.hasOwnProperty),Fe=Object.hasOwn||function(e,t){return He(qe(e),t)},Qe=L,Be=0,ze=Math.random(),We=Qe(1..toString),Ge=function(e){return"Symbol("+(void 0===e?"":e)+")_"+We(++Be+ze,36)},Xe=n,Je=Pe.exports,Ke=Fe,Ye=Ge,$e=ue,Ze=he,et=Je("wks"),tt=Xe.Symbol,nt=tt&&tt.for,rt=Ze?tt:tt&&tt.withoutSetter||Ye,it=function(e){if(!Ke(et,e)||!$e&&"string"!=typeof et[e]){var t="Symbol."+e;$e&&Ke(tt,e)?et[e]=tt[e]:et[e]=Ze&&nt?nt(t):rt(t)}return et[e]},ot=u,st=G,at=ve,ct=Oe,ut=function(e,t){var n,r;if("string"===t&&xe(n=e.toString)&&!Ce(r=Te(n,e)))return r;if(xe(n=e.valueOf)&&!Ce(r=Te(n,e)))return r;if("string"!==t&&xe(n=e.toString)&&!Ce(r=Te(n,e)))return r;throw Le("Can't convert object to primitive value")},ht=TypeError,lt=it("toPrimitive"),ft=function(e,t){if(!st(e)||at(e))return e;var n,r=ct(e,lt);if(r){if(void 0===t&&(t="default"),n=ot(r,e,t),!st(n)||at(n))return n;throw ht("Can't convert object to primitive value")}return void 0===t&&(t="number"),ut(e,t)},dt=ve,pt=function(e){var t=ft(e,"string");return dt(t)?t:t+""},vt=G,mt=n.document,gt=vt(mt)&&vt(mt.createElement),yt=function(e){return gt?mt.createElement(e):{}},wt=yt,bt=!o&&!i((function(){return 7!=Object.defineProperty(wt("div"),"a",{get:function(){return 7}}).a})),kt=o,Et=u,St=h,Ot=m,Tt=q,xt=pt,Ct=Fe,Lt=bt,Pt=Object.getOwnPropertyDescriptor;r.f=kt?Pt:function(e,t){if(e=Tt(e),t=xt(t),Lt)try{return Pt(e,t)}catch(e){}if(Ct(e,t))return Ot(!Et(St.f,e,t),e[t])};var It={},jt=o&&i((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),Rt=G,At=String,Vt=TypeError,Nt=function(e){if(Rt(e))return e;throw Vt(At(e)+" is not an object")},_t=o,Dt=bt,Mt=jt,Ut=Nt,qt=pt,Ht=TypeError,Ft=Object.defineProperty,Qt=Object.getOwnPropertyDescriptor,Bt="enumerable",zt="configurable",Wt="writable";It.f=_t?Mt?function(e,t,n){if(Ut(e),t=qt(t),Ut(n),"function"==typeof e&&"prototype"===t&&"value"in n&&Wt in n&&!n.writable){var r=Qt(e,t);r&&r.writable&&(e[t]=n.value,n={configurable:zt in n?n.configurable:r.configurable,enumerable:Bt in n?n.enumerable:r.enumerable,writable:!1})}return Ft(e,t,n)}:Ft:function(e,t,n){if(Ut(e),t=qt(t),Ut(n),Dt)try{return Ft(e,t,n)}catch(e){}if("get"in n||"set"in n)throw Ht("Accessors not supported");return"value"in n&&(e[t]=n.value),e};var Gt=It,Xt=m,Jt=o?function(e,t,n){return Gt.f(e,t,Xt(1,n))}:function(e,t,n){return e[t]=n,e},Kt={exports:{}},Yt=o,$t=Fe,Zt=Function.prototype,en=Yt&&Object.getOwnPropertyDescriptor,tn=$t(Zt,"name"),nn={EXISTS:tn,PROPER:tn&&"something"===function(){}.name,CONFIGURABLE:tn&&(!Yt||Yt&&en(Zt,"name").configurable)},rn=B,on=Ne,sn=L(Function.toString);rn(on.inspectSource)||(on.inspectSource=function(e){return sn(e)});var an,cn,un,hn=on.inspectSource,ln=B,fn=n.WeakMap,dn=ln(fn)&&/native code/.test(String(fn)),pn=Pe.exports,vn=Ge,mn=pn("keys"),gn=function(e){return mn[e]||(mn[e]=vn(e))},yn={},wn=dn,bn=n,kn=G,En=Jt,Sn=Fe,On=Ne,Tn=gn,xn=yn,Cn="Object already initialized",Ln=bn.TypeError,Pn=bn.WeakMap;if(wn||On.state){var In=On.state||(On.state=new Pn);In.get=In.get,In.has=In.has,In.set=In.set,an=function(e,t){if(In.has(e))throw Ln(Cn);return t.facade=e,In.set(e,t),t},cn=function(e){return In.get(e)||{}},un=function(e){return In.has(e)}}else{var jn=Tn("state");xn[jn]=!0,an=function(e,t){if(Sn(e,jn))throw Ln(Cn);return t.facade=e,En(e,jn,t),t},cn=function(e){return Sn(e,jn)?e[jn]:{}},un=function(e){return Sn(e,jn)}}var Rn={set:an,get:cn,has:un,enforce:function(e){return un(e)?cn(e):an(e,{})},getterFor:function(e){return function(t){var n;if(!kn(t)||(n=cn(t)).type!==e)throw Ln("Incompatible receiver, "+e+" required");return n}}},An=i,Vn=B,Nn=Fe,_n=o,Dn=nn.CONFIGURABLE,Mn=hn,Un=Rn.enforce,qn=Rn.get,Hn=Object.defineProperty,Fn=_n&&!An((function(){return 8!==Hn((function(){}),"length",{value:8}).length})),Qn=String(String).split("String"),Bn=Kt.exports=function(e,t,n){"Symbol("===String(t).slice(0,7)&&(t="["+String(t).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),n&&n.getter&&(t="get "+t),n&&n.setter&&(t="set "+t),(!Nn(e,"name")||Dn&&e.name!==t)&&(_n?Hn(e,"name",{value:t,configurable:!0}):e.name=t),Fn&&n&&Nn(n,"arity")&&e.length!==n.arity&&Hn(e,"length",{value:n.arity});try{n&&Nn(n,"constructor")&&n.constructor?_n&&Hn(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch(e){}var r=Un(e);return Nn(r,"source")||(r.source=Qn.join("string"==typeof t?t:"")),e};Function.prototype.toString=Bn((function(){return Vn(this)&&qn(this).source||Mn(this)}),"toString");var zn=B,Wn=It,Gn=Kt.exports,Xn=Re,Jn=function(e,t,n,r){r||(r={});var i=r.enumerable,o=void 0!==r.name?r.name:t;if(zn(n)&&Gn(n,o,r),r.global)i?e[t]=n:Xn(t,n);else{try{r.unsafe?e[t]&&(i=!0):delete e[t]}catch(e){}i?e[t]=n:Wn.f(e,t,{value:n,enumerable:!1,configurable:!r.nonConfigurable,writable:!r.nonWritable})}return e},Kn={},Yn=Math.ceil,$n=Math.floor,Zn=Math.trunc||function(e){var t=+e;return(t>0?$n:Yn)(t)},er=Zn,tr=function(e){var t=+e;return t!=t||0===t?0:er(t)},nr=tr,rr=Math.max,ir=Math.min,or=tr,sr=Math.min,ar=function(e){return e>0?sr(or(e),9007199254740991):0},cr=function(e){return ar(e.length)},ur=q,hr=function(e,t){var n=nr(e);return n<0?rr(n+t,0):ir(n,t)},lr=cr,fr=function(e){return function(t,n,r){var i,o=ur(t),s=lr(o),a=hr(r,s);if(e&&n!=n){for(;s>a;)if((i=o[a++])!=i)return!0}else for(;s>a;a++)if((e||a in o)&&o[a]===n)return e||a||0;return!e&&-1}},dr={includes:fr(!0),indexOf:fr(!1)},pr=Fe,vr=q,mr=dr.indexOf,gr=yn,yr=L([].push),wr=function(e,t){var n,r=vr(e),i=0,o=[];for(n in r)!pr(gr,n)&&pr(r,n)&&yr(o,n);for(;t.length>i;)pr(r,n=t[i++])&&(~mr(o,n)||yr(o,n));return o},br=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],kr=wr,Er=br.concat("length","prototype");Kn.f=Object.getOwnPropertyNames||function(e){return kr(e,Er)};var Sr={};Sr.f=Object.getOwnPropertySymbols;var Or=Y,Tr=Kn,xr=Sr,Cr=Nt,Lr=L([].concat),Pr=Or("Reflect","ownKeys")||function(e){var t=Tr.f(Cr(e)),n=xr.f;return n?Lr(t,n(e)):t},Ir=Fe,jr=Pr,Rr=r,Ar=It,Vr=function(e,t,n){for(var r=jr(t),i=Ar.f,o=Rr.f,s=0;s<r.length;s++){var a=r[s];Ir(e,a)||n&&Ir(n,a)||i(e,a,o(t,a))}},Nr=i,_r=B,Dr=/#|\.prototype\./,Mr=function(e,t){var n=qr[Ur(e)];return n==Fr||n!=Hr&&(_r(t)?Nr(t):!!t)},Ur=Mr.normalize=function(e){return String(e).replace(Dr,".").toLowerCase()},qr=Mr.data={},Hr=Mr.NATIVE="N",Fr=Mr.POLYFILL="P",Qr=Mr,Br=n,zr=r.f,Wr=Jt,Gr=Jn,Xr=Re,Jr=Vr,Kr=Qr,Yr=function(e,t){var n,r,i,o,s,a=e.target,c=e.global,u=e.stat;if(n=c?Br:u?Br[a]||Xr(a,{}):(Br[a]||{}).prototype)for(r in t){if(o=t[r],i=e.dontCallGetSet?(s=zr(n,r))&&s.value:n[r],!Kr(c?r:a+(u?".":"#")+r,e.forced)&&void 0!==i){if(typeof o==typeof i)continue;Jr(o,i)}(e.sham||i&&i.sham)&&Wr(o,"sham",!0),Gr(n,r,o,e)}},$r={},Zr=wr,ei=br,ti=Object.keys||function(e){return Zr(e,ei)},ni=o,ri=jt,ii=It,oi=Nt,si=q,ai=ti;$r.f=ni&&!ri?Object.defineProperties:function(e,t){oi(e);for(var n,r=si(t),i=ai(t),o=i.length,s=0;o>s;)ii.f(e,n=i[s++],r[n]);return e};var ci,ui=Y("document","documentElement"),hi=Nt,li=$r,fi=br,di=yn,pi=ui,vi=yt,mi=gn("IE_PROTO"),gi=function(){},yi=function(e){return"<script>"+e+"</"+"script>"},wi=function(e){e.write(yi("")),e.close();var t=e.parentWindow.Object;return e=null,t},bi=function(){try{ci=new ActiveXObject("htmlfile")}catch(e){}var e,t;bi="undefined"!=typeof document?document.domain&&ci?wi(ci):((t=vi("iframe")).style.display="none",pi.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(yi("document.F=Object")),e.close(),e.F):wi(ci);for(var n=fi.length;n--;)delete bi.prototype[fi[n]];return bi()};di[mi]=!0;var ki=Object.create||function(e,t){var n;return null!==e?(gi.prototype=hi(e),n=new gi,gi.prototype=null,n[mi]=e):n=bi(),void 0===t?n:li.f(n,t)},Ei=it,Si=ki,Oi=It.f,Ti=Ei("unscopables"),xi=Array.prototype;null==xi[Ti]&&Oi(xi,Ti,{configurable:!0,value:Si(null)});var Ci=function(e){xi[Ti][e]=!0},Li=dr.includes,Pi=Ci;Yr({target:"Array",proto:!0,forced:i((function(){return!Array(1).includes()}))},{includes:function(e){return Li(this,e,arguments.length>1?arguments[1]:void 0)}}),Pi("includes");var Ii=n,ji=L,Ri=function(e,t){return ji(Ii[e].prototype[t])};Ri("Array","includes");var Ai=G,Vi=T,Ni=it("match"),_i=function(e){var t;return Ai(e)&&(void 0!==(t=e[Ni])?!!t:"RegExp"==Vi(e))},Di=TypeError,Mi={};Mi[it("toStringTag")]="z";var Ui="[object z]"===String(Mi),qi=Ui,Hi=B,Fi=T,Qi=it("toStringTag"),Bi=Object,zi="Arguments"==Fi(function(){return arguments}()),Wi=qi?Fi:function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=Bi(e),Qi))?n:zi?Fi(t):"Object"==(r=Fi(t))&&Hi(t.callee)?"Arguments":r},Gi=Wi,Xi=String,Ji=function(e){if("Symbol"===Gi(e))throw TypeError("Cannot convert a Symbol value to a string");return Xi(e)},Ki=it("match"),Yi=Yr,$i=function(e){if(_i(e))throw Di("The method doesn't accept regular expressions");return e},Zi=D,eo=Ji,to=function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[Ki]=!1,"/./"[e](t)}catch(e){}}return!1},no=L("".indexOf);Yi({target:"String",proto:!0,forced:!to("includes")},{includes:function(e){return!!~no(eo(Zi(this)),eo($i(e)),arguments.length>1?arguments[1]:void 0)}}),Ri("String","includes");var ro=ke,io=s,oo=L(L.bind),so=function(e,t){return ro(e),void 0===t?e:io?oo(e,t):function(){return e.apply(t,arguments)}},ao=T,co=Array.isArray||function(e){return"Array"==ao(e)},uo=L,ho=i,lo=B,fo=Wi,po=hn,vo=function(){},mo=[],go=Y("Reflect","construct"),yo=/^\s*(?:class|function)\b/,wo=uo(yo.exec),bo=!yo.exec(vo),ko=function(e){if(!lo(e))return!1;try{return go(vo,mo,e),!0}catch(e){return!1}},Eo=function(e){if(!lo(e))return!1;switch(fo(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return bo||!!wo(yo,po(e))}catch(e){return!0}};Eo.sham=!0;var So=!go||ho((function(){var e;return ko(ko.call)||!ko(Object)||!ko((function(){e=!0}))||e}))?Eo:ko,Oo=co,To=So,xo=G,Co=it("species"),Lo=Array,Po=function(e){var t;return Oo(e)&&(t=e.constructor,(To(t)&&(t===Lo||Oo(t.prototype))||xo(t)&&null===(t=t[Co]))&&(t=void 0)),void 0===t?Lo:t},Io=so,jo=A,Ro=Ue,Ao=cr,Vo=function(e,t){return new(Po(e))(0===t?0:t)},No=L([].push),_o=function(e){var t=1==e,n=2==e,r=3==e,i=4==e,o=6==e,s=7==e,a=5==e||o;return function(c,u,h,l){for(var f,d,p=Ro(c),v=jo(p),m=Io(u,h),g=Ao(v),y=0,w=l||Vo,b=t?w(c,g):n||s?w(c,0):void 0;g>y;y++)if((a||y in v)&&(d=m(f=v[y],y,p),e))if(t)b[y]=d;else if(d)switch(e){case 3:return!0;case 5:return f;case 6:return y;case 2:No(b,f)}else switch(e){case 4:return!1;case 7:No(b,f)}return o?-1:r||i?i:b}},Do=Yr,Mo={forEach:_o(0),map:_o(1),filter:_o(2),some:_o(3),every:_o(4),find:_o(5),findIndex:_o(6),filterReject:_o(7)}.find,Uo=Ci,qo="find",Ho=!0;qo in[]&&Array(1).find((function(){Ho=!1})),Do({target:"Array",proto:!0,forced:Ho},{find:function(e){return Mo(this,e,arguments.length>1?arguments[1]:void 0)}}),Uo(qo),Ri("Array","find");var Fo=o,Qo=L,Bo=u,zo=i,Wo=ti,Go=Sr,Xo=h,Jo=Ue,Ko=A,Yo=Object.assign,$o=Object.defineProperty,Zo=Qo([].concat),es=!Yo||zo((function(){if(Fo&&1!==Yo({b:1},Yo($o({},"a",{enumerable:!0,get:function(){$o(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach((function(e){t[e]=e})),7!=Yo({},e)[n]||Wo(Yo({},t)).join("")!=r}))?function(e,t){for(var n=Jo(e),r=arguments.length,i=1,o=Go.f,s=Xo.f;r>i;)for(var a,c=Ko(arguments[i++]),u=o?Zo(Wo(c),o(c)):Wo(c),h=u.length,l=0;h>l;)a=u[l++],Fo&&!Bo(s,c,a)||(n[a]=c[a]);return n}:Yo,ts=es;Yr({target:"Object",stat:!0,arity:2,forced:Object.assign!==ts},{assign:ts});var ns=n;ns.Object.assign;var rs=!i((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype})),is=Fe,os=B,ss=Ue,as=rs,cs=gn("IE_PROTO"),us=Object,hs=us.prototype,ls=as?us.getPrototypeOf:function(e){var t=ss(e);if(is(t,cs))return t[cs];var n=t.constructor;return os(n)&&t instanceof n?n.prototype:t instanceof us?hs:null},fs=B,ds=String,ps=TypeError,vs=L,ms=Nt,gs=function(e){if("object"==typeof e||fs(e))return e;throw ps("Can't set "+ds(e)+" as a prototype")},ys=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{(e=vs(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(n,[]),t=n instanceof Array}catch(e){}return function(n,r){return ms(n),gs(r),t?e(n,r):n.__proto__=r,n}}():void 0),ws=Error,bs=L("".replace),ks=String(ws("zxcasd").stack),Es=/\n\s*at [^:]*:[^\n]*/,Ss=Es.test(ks),Os=G,Ts=Jt,xs={},Cs=xs,Ls=it("iterator"),Ps=Array.prototype,Is=Wi,js=Oe,Rs=V,As=xs,Vs=it("iterator"),Ns=function(e){if(!Rs(e))return js(e,Vs)||js(e,"@@iterator")||As[Is(e)]},_s=u,Ds=ke,Ms=Nt,Us=ge,qs=Ns,Hs=TypeError,Fs=u,Qs=Nt,Bs=Oe,zs=so,Ws=u,Gs=Nt,Xs=ge,Js=function(e){return void 0!==e&&(Cs.Array===e||Ps[Ls]===e)},Ks=cr,Ys=$,$s=function(e,t){var n=arguments.length<2?qs(e):t;if(Ds(n))return Ms(_s(n,e));throw Hs(Us(e)+" is not iterable")},Zs=Ns,ea=function(e,t,n){var r,i;Qs(e);try{if(!(r=Bs(e,"return"))){if("throw"===t)throw n;return n}r=Fs(r,e)}catch(e){i=!0,r=e}if("throw"===t)throw n;if(i)throw r;return Qs(r),n},ta=TypeError,na=function(e,t){this.stopped=e,this.result=t},ra=na.prototype,ia=function(e,t,n){var r,i,o,s,a,c,u,h=n&&n.that,l=!(!n||!n.AS_ENTRIES),f=!(!n||!n.IS_RECORD),d=!(!n||!n.IS_ITERATOR),p=!(!n||!n.INTERRUPTED),v=zs(t,h),m=function(e){return r&&ea(r,"normal",e),new na(!0,e)},g=function(e){return l?(Gs(e),p?v(e[0],e[1],m):v(e[0],e[1])):p?v(e,m):v(e)};if(f)r=e.iterator;else if(d)r=e;else{if(!(i=Zs(e)))throw ta(Xs(e)+" is not iterable");if(Js(i)){for(o=0,s=Ks(e);s>o;o++)if((a=g(e[o]))&&Ys(ra,a))return a;return new na(!1)}r=$s(e,i)}for(c=f?e.next:r.next;!(u=Ws(c,r)).done;){try{a=g(u.value)}catch(e){ea(r,"throw",e)}if("object"==typeof a&&a&&Ys(ra,a))return a}return new na(!1)},oa=Ji,sa=m,aa=!i((function(){var e=Error("a");return!("stack"in e)||(Object.defineProperty(e,"stack",sa(1,7)),7!==e.stack)})),ca=Yr,ua=$,ha=ls,la=ys,fa=Vr,da=ki,pa=Jt,va=m,ma=function(e,t){if(Ss&&"string"==typeof e&&!ws.prepareStackTrace)for(;t--;)e=bs(e,Es,"");return e},ga=function(e,t){Os(t)&&"cause"in t&&Ts(e,"cause",t.cause)},ya=ia,wa=function(e,t){return void 0===e?arguments.length<2?"":t:oa(e)},ba=aa,ka=it("toStringTag"),Ea=Error,Sa=[].push,Oa=function(e,t){var n,r=arguments.length>2?arguments[2]:void 0,i=ua(Ta,this);la?n=la(Ea(),i?ha(this):Ta):(n=i?this:da(Ta),pa(n,ka,"Error")),void 0!==t&&pa(n,"message",wa(t)),ba&&pa(n,"stack",ma(n.stack,1)),ga(n,r);var o=[];return ya(e,Sa,{that:o}),pa(n,"errors",o),n};la?la(Oa,Ea):fa(Oa,Ea,{name:!0});var Ta=Oa.prototype=da(Ea.prototype,{constructor:va(1,Oa),message:va(1,""),name:va(1,"AggregateError")});ca({global:!0,constructor:!0,arity:2},{AggregateError:Oa});var xa,Ca,La,Pa=i,Ia=B,ja=G,Ra=ls,Aa=Jn,Va=it("iterator"),Na=!1;[].keys&&("next"in(La=[].keys())?(Ca=Ra(Ra(La)))!==Object.prototype&&(xa=Ca):Na=!0);var _a=!ja(xa)||Pa((function(){var e={};return xa[Va].call(e)!==e}));_a&&(xa={}),Ia(xa[Va])||Aa(xa,Va,(function(){return this}));var Da={IteratorPrototype:xa,BUGGY_SAFARI_ITERATORS:Na},Ma=It.f,Ua=Fe,qa=it("toStringTag"),Ha=function(e,t,n){e&&!n&&(e=e.prototype),e&&!Ua(e,qa)&&Ma(e,qa,{configurable:!0,value:t})},Fa=Da.IteratorPrototype,Qa=ki,Ba=m,za=Ha,Wa=xs,Ga=function(){return this},Xa=Yr,Ja=u,Ka=B,Ya=function(e,t,n,r){var i=t+" Iterator";return e.prototype=Qa(Fa,{next:Ba(+!r,n)}),za(e,i,!1),Wa[i]=Ga,e},$a=ls,Za=ys,ec=Ha,tc=Jt,nc=Jn,rc=xs,ic=nn.PROPER,oc=nn.CONFIGURABLE,sc=Da.IteratorPrototype,ac=Da.BUGGY_SAFARI_ITERATORS,cc=it("iterator"),uc="keys",hc="values",lc="entries",fc=function(){return this},dc=function(e,t,n,r,i,o,s){Ya(n,t,r);var a,c,u,h=function(e){if(e===i&&v)return v;if(!ac&&e in d)return d[e];switch(e){case uc:case hc:case lc:return function(){return new n(this,e)}}return function(){return new n(this)}},l=t+" Iterator",f=!1,d=e.prototype,p=d[cc]||d["@@iterator"]||i&&d[i],v=!ac&&p||h(i),m="Array"==t&&d.entries||p;if(m&&(a=$a(m.call(new e)))!==Object.prototype&&a.next&&($a(a)!==sc&&(Za?Za(a,sc):Ka(a[cc])||nc(a,cc,fc)),ec(a,l,!0)),ic&&i==hc&&p&&p.name!==hc&&(oc?tc(d,"name",hc):(f=!0,v=function(){return Ja(p,this)})),i)if(c={values:h(hc),keys:o?v:h(uc),entries:h(lc)},s)for(u in c)(ac||f||!(u in d))&&nc(d,u,c[u]);else Xa({target:t,proto:!0,forced:ac||f},c);return d[cc]!==v&&nc(d,cc,v,{name:i}),rc[t]=v,c},pc=function(e,t){return{value:e,done:t}},vc=q,mc=Ci,gc=xs,yc=Rn,wc=It.f,bc=dc,kc=pc,Ec=o,Sc="Array Iterator",Oc=yc.set,Tc=yc.getterFor(Sc),xc=bc(Array,"Array",(function(e,t){Oc(this,{type:Sc,target:vc(e),index:0,kind:t})}),(function(){var e=Tc(this),t=e.target,n=e.kind,r=e.index++;return!t||r>=t.length?(e.target=void 0,kc(void 0,!0)):kc("keys"==n?r:"values"==n?t[r]:[r,t[r]],!1)}),"values"),Cc=gc.Arguments=gc.Array;if(mc("keys"),mc("values"),mc("entries"),Ec&&"values"!==Cc.name)try{wc(Cc,"name",{value:"values"})}catch(e){}var Lc=Wi,Pc=Ui?{}.toString:function(){return"[object "+Lc(this)+"]"};Ui||Jn(Object.prototype,"toString",Pc,{unsafe:!0});var Ic,jc,Rc,Ac,Vc="process"==T(n.process),Nc=Y,_c=It,Dc=o,Mc=it("species"),Uc=$,qc=TypeError,Hc=So,Fc=ge,Qc=TypeError,Bc=Nt,zc=function(e){if(Hc(e))return e;throw Qc(Fc(e)+" is not a constructor")},Wc=V,Gc=it("species"),Xc=function(e,t){var n,r=Bc(e).constructor;return void 0===r||Wc(n=Bc(r)[Gc])?t:zc(n)},Jc=s,Kc=Function.prototype,Yc=Kc.apply,$c=Kc.call,Zc="object"==typeof Reflect&&Reflect.apply||(Jc?$c.bind(Yc):function(){return $c.apply(Yc,arguments)}),eu=L([].slice),tu=TypeError,nu=/(?:ipad|iphone|ipod).*applewebkit/i.test(Z),ru=n,iu=Zc,ou=so,su=B,au=Fe,cu=i,uu=ui,hu=eu,lu=yt,fu=function(e,t){if(e<t)throw tu("Not enough arguments");return e},du=nu,pu=Vc,vu=ru.setImmediate,mu=ru.clearImmediate,gu=ru.process,yu=ru.Dispatch,wu=ru.Function,bu=ru.MessageChannel,ku=ru.String,Eu=0,Su={},Ou="onreadystatechange";try{Ic=ru.location}catch(e){}var Tu=function(e){if(au(Su,e)){var t=Su[e];delete Su[e],t()}},xu=function(e){return function(){Tu(e)}},Cu=function(e){Tu(e.data)},Lu=function(e){ru.postMessage(ku(e),Ic.protocol+"//"+Ic.host)};vu&&mu||(vu=function(e){fu(arguments.length,1);var t=su(e)?e:wu(e),n=hu(arguments,1);return Su[++Eu]=function(){iu(t,void 0,n)},jc(Eu),Eu},mu=function(e){delete Su[e]},pu?jc=function(e){gu.nextTick(xu(e))}:yu&&yu.now?jc=function(e){yu.now(xu(e))}:bu&&!du?(Ac=(Rc=new bu).port2,Rc.port1.onmessage=Cu,jc=ou(Ac.postMessage,Ac)):ru.addEventListener&&su(ru.postMessage)&&!ru.importScripts&&Ic&&"file:"!==Ic.protocol&&!cu(Lu)?(jc=Lu,ru.addEventListener("message",Cu,!1)):jc=Ou in lu("script")?function(e){uu.appendChild(lu("script")).onreadystatechange=function(){uu.removeChild(this),Tu(e)}}:function(e){setTimeout(xu(e),0)});var Pu,Iu,ju,Ru,Au,Vu,Nu,_u,Du={set:vu,clear:mu},Mu=n,Uu=/ipad|iphone|ipod/i.test(Z)&&void 0!==Mu.Pebble,qu=/web0s(?!.*chrome)/i.test(Z),Hu=n,Fu=so,Qu=r.f,Bu=Du.set,zu=nu,Wu=Uu,Gu=qu,Xu=Vc,Ju=Hu.MutationObserver||Hu.WebKitMutationObserver,Ku=Hu.document,Yu=Hu.process,$u=Hu.Promise,Zu=Qu(Hu,"queueMicrotask"),eh=Zu&&Zu.value;eh||(Pu=function(){var e,t;for(Xu&&(e=Yu.domain)&&e.exit();Iu;){t=Iu.fn,Iu=Iu.next;try{t()}catch(e){throw Iu?Ru():ju=void 0,e}}ju=void 0,e&&e.enter()},zu||Xu||Gu||!Ju||!Ku?!Wu&&$u&&$u.resolve?((Nu=$u.resolve(void 0)).constructor=$u,_u=Fu(Nu.then,Nu),Ru=function(){_u(Pu)}):Xu?Ru=function(){Yu.nextTick(Pu)}:(Bu=Fu(Bu,Hu),Ru=function(){Bu(Pu)}):(Au=!0,Vu=Ku.createTextNode(""),new Ju(Pu).observe(Vu,{characterData:!0}),Ru=function(){Vu.data=Au=!Au}));var th=eh||function(e){var t={fn:e,next:void 0};ju&&(ju.next=t),Iu||(Iu=t,Ru()),ju=t},nh=n,rh=function(e){try{return{error:!1,value:e()}}catch(e){return{error:!0,value:e}}},ih=function(){this.head=null,this.tail=null};ih.prototype={add:function(e){var t={item:e,next:null};this.head?this.tail.next=t:this.head=t,this.tail=t},get:function(){var e=this.head;if(e)return this.head=e.next,this.tail===e&&(this.tail=null),e.item}};var oh=ih,sh=n.Promise,ah="object"==typeof Deno&&Deno&&"object"==typeof Deno.version,ch=!ah&&!Vc&&"object"==typeof window&&"object"==typeof document,uh=n,hh=sh,lh=B,fh=Qr,dh=hn,ph=it,vh=ch,mh=ah,gh=se;hh&&hh.prototype;var yh=ph("species"),wh=!1,bh=lh(uh.PromiseRejectionEvent),kh=fh("Promise",(function(){var e=dh(hh),t=e!==String(hh);if(!t&&66===gh)return!0;if(!gh||gh<51||!/native code/.test(e)){var n=new hh((function(e){e(1)})),r=function(e){e((function(){}),(function(){}))};if((n.constructor={})[yh]=r,!(wh=n.then((function(){}))instanceof r))return!0}return!t&&(vh||mh)&&!bh})),Eh={CONSTRUCTOR:kh,REJECTION_EVENT:bh,SUBCLASSING:wh},Sh={},Oh=ke,Th=TypeError,xh=function(e){var t,n;this.promise=new e((function(e,r){if(void 0!==t||void 0!==n)throw Th("Bad Promise constructor");t=e,n=r})),this.resolve=Oh(t),this.reject=Oh(n)};Sh.f=function(e){return new xh(e)};var Ch,Lh,Ph,Ih=Yr,jh=Vc,Rh=n,Ah=u,Vh=Jn,Nh=ys,_h=Ha,Dh=function(e){var t=Nc(e),n=_c.f;Dc&&t&&!t[Mc]&&n(t,Mc,{configurable:!0,get:function(){return this}})},Mh=ke,Uh=B,qh=G,Hh=function(e,t){if(Uc(t,e))return e;throw qc("Incorrect invocation")},Fh=Xc,Qh=Du.set,Bh=th,zh=function(e,t){var n=nh.console;n&&n.error&&(1==arguments.length?n.error(e):n.error(e,t))},Wh=rh,Gh=oh,Xh=Rn,Jh=sh,Kh=Sh,Yh="Promise",$h=Eh.CONSTRUCTOR,Zh=Eh.REJECTION_EVENT,el=Eh.SUBCLASSING,tl=Xh.getterFor(Yh),nl=Xh.set,rl=Jh&&Jh.prototype,il=Jh,ol=rl,sl=Rh.TypeError,al=Rh.document,cl=Rh.process,ul=Kh.f,hl=ul,ll=!!(al&&al.createEvent&&Rh.dispatchEvent),fl="unhandledrejection",dl=function(e){var t;return!(!qh(e)||!Uh(t=e.then))&&t},pl=function(e,t){var n,r,i,o=t.value,s=1==t.state,a=s?e.ok:e.fail,c=e.resolve,u=e.reject,h=e.domain;try{a?(s||(2===t.rejection&&wl(t),t.rejection=1),!0===a?n=o:(h&&h.enter(),n=a(o),h&&(h.exit(),i=!0)),n===e.promise?u(sl("Promise-chain cycle")):(r=dl(n))?Ah(r,n,c,u):c(n)):u(o)}catch(e){h&&!i&&h.exit(),u(e)}},vl=function(e,t){e.notified||(e.notified=!0,Bh((function(){for(var n,r=e.reactions;n=r.get();)pl(n,e);e.notified=!1,t&&!e.rejection&&gl(e)})))},ml=function(e,t,n){var r,i;ll?((r=al.createEvent("Event")).promise=t,r.reason=n,r.initEvent(e,!1,!0),Rh.dispatchEvent(r)):r={promise:t,reason:n},!Zh&&(i=Rh["on"+e])?i(r):e===fl&&zh("Unhandled promise rejection",n)},gl=function(e){Ah(Qh,Rh,(function(){var t,n=e.facade,r=e.value;if(yl(e)&&(t=Wh((function(){jh?cl.emit("unhandledRejection",r,n):ml(fl,n,r)})),e.rejection=jh||yl(e)?2:1,t.error))throw t.value}))},yl=function(e){return 1!==e.rejection&&!e.parent},wl=function(e){Ah(Qh,Rh,(function(){var t=e.facade;jh?cl.emit("rejectionHandled",t):ml("rejectionhandled",t,e.value)}))},bl=function(e,t,n){return function(r){e(t,r,n)}},kl=function(e,t,n){e.done||(e.done=!0,n&&(e=n),e.value=t,e.state=2,vl(e,!0))},El=function(e,t,n){if(!e.done){e.done=!0,n&&(e=n);try{if(e.facade===t)throw sl("Promise can't be resolved itself");var r=dl(t);r?Bh((function(){var n={done:!1};try{Ah(r,t,bl(El,n,e),bl(kl,n,e))}catch(t){kl(n,t,e)}})):(e.value=t,e.state=1,vl(e,!1))}catch(t){kl({done:!1},t,e)}}};if($h&&(ol=(il=function(e){Hh(this,ol),Mh(e),Ah(Ch,this);var t=tl(this);try{e(bl(El,t),bl(kl,t))}catch(e){kl(t,e)}}).prototype,(Ch=function(e){nl(this,{type:Yh,done:!1,notified:!1,parent:!1,reactions:new Gh,rejection:!1,state:0,value:void 0})}).prototype=Vh(ol,"then",(function(e,t){var n=tl(this),r=ul(Fh(this,il));return n.parent=!0,r.ok=!Uh(e)||e,r.fail=Uh(t)&&t,r.domain=jh?cl.domain:void 0,0==n.state?n.reactions.add(r):Bh((function(){pl(r,n)})),r.promise})),Lh=function(){var e=new Ch,t=tl(e);this.promise=e,this.resolve=bl(El,t),this.reject=bl(kl,t)},Kh.f=ul=function(e){return e===il||undefined===e?new Lh(e):hl(e)},Uh(Jh)&&rl!==Object.prototype)){Ph=rl.then,el||Vh(rl,"then",(function(e,t){var n=this;return new il((function(e,t){Ah(Ph,n,e,t)})).then(e,t)}),{unsafe:!0});try{delete rl.constructor}catch(e){}Nh&&Nh(rl,ol)}Ih({global:!0,constructor:!0,wrap:!0,forced:$h},{Promise:il}),_h(il,Yh,!1),Dh(Yh);var Sl=it("iterator"),Ol=!1;try{var Tl=0,xl={next:function(){return{done:!!Tl++}},return:function(){Ol=!0}};xl[Sl]=function(){return this},Array.from(xl,(function(){throw 2}))}catch(e){}var Cl=sh,Ll=function(e,t){if(!t&&!Ol)return!1;var n=!1;try{var r={};r[Sl]=function(){return{next:function(){return{done:n=!0}}}},e(r)}catch(e){}return n},Pl=Eh.CONSTRUCTOR||!Ll((function(e){Cl.all(e).then(void 0,(function(){}))})),Il=u,jl=ke,Rl=Sh,Al=rh,Vl=ia;Yr({target:"Promise",stat:!0,forced:Pl},{all:function(e){var t=this,n=Rl.f(t),r=n.resolve,i=n.reject,o=Al((function(){var n=jl(t.resolve),o=[],s=0,a=1;Vl(e,(function(e){var c=s++,u=!1;a++,Il(n,t,e).then((function(e){u||(u=!0,o[c]=e,--a||r(o))}),i)})),--a||r(o)}));return o.error&&i(o.value),n.promise}});var Nl=Yr,_l=Eh.CONSTRUCTOR,Dl=sh,Ml=Y,Ul=B,ql=Jn,Hl=Dl&&Dl.prototype;if(Nl({target:"Promise",proto:!0,forced:_l,real:!0},{catch:function(e){return this.then(void 0,e)}}),Ul(Dl)){var Fl=Ml("Promise").prototype.catch;Hl.catch!==Fl&&ql(Hl,"catch",Fl,{unsafe:!0})}var Ql=u,Bl=ke,zl=Sh,Wl=rh,Gl=ia;Yr({target:"Promise",stat:!0,forced:Pl},{race:function(e){var t=this,n=zl.f(t),r=n.reject,i=Wl((function(){var i=Bl(t.resolve);Gl(e,(function(e){Ql(i,t,e).then(n.resolve,r)}))}));return i.error&&r(i.value),n.promise}});var Xl=u,Jl=Sh;Yr({target:"Promise",stat:!0,forced:Eh.CONSTRUCTOR},{reject:function(e){var t=Jl.f(this);return Xl(t.reject,void 0,e),t.promise}});var Kl=Nt,Yl=G,$l=Sh,Zl=function(e,t){if(Kl(e),Yl(t)&&t.constructor===e)return t;var n=$l.f(e);return(0,n.resolve)(t),n.promise},ef=Yr,tf=Eh.CONSTRUCTOR,nf=Zl;Y("Promise"),ef({target:"Promise",stat:!0,forced:tf},{resolve:function(e){return nf(this,e)}});var rf=u,of=ke,sf=Sh,af=rh,cf=ia;Yr({target:"Promise",stat:!0},{allSettled:function(e){var t=this,n=sf.f(t),r=n.resolve,i=n.reject,o=af((function(){var n=of(t.resolve),i=[],o=0,s=1;cf(e,(function(e){var a=o++,c=!1;s++,rf(n,t,e).then((function(e){c||(c=!0,i[a]={status:"fulfilled",value:e},--s||r(i))}),(function(e){c||(c=!0,i[a]={status:"rejected",reason:e},--s||r(i))}))})),--s||r(i)}));return o.error&&i(o.value),n.promise}});var uf=u,hf=ke,lf=Y,ff=Sh,df=rh,pf=ia,vf="No one promise resolved";Yr({target:"Promise",stat:!0},{any:function(e){var t=this,n=lf("AggregateError"),r=ff.f(t),i=r.resolve,o=r.reject,s=df((function(){var r=hf(t.resolve),s=[],a=0,c=1,u=!1;pf(e,(function(e){var h=a++,l=!1;c++,uf(r,t,e).then((function(e){l||u||(u=!0,i(e))}),(function(e){l||u||(l=!0,s[h]=e,--c||o(new n(s,vf)))}))})),--c||o(new n(s,vf))}));return s.error&&o(s.value),r.promise}});var mf=Yr,gf=sh,yf=i,wf=Y,bf=B,kf=Xc,Ef=Zl,Sf=Jn,Of=gf&&gf.prototype;if(mf({target:"Promise",proto:!0,real:!0,forced:!!gf&&yf((function(){Of.finally.call({then:function(){}},(function(){}))}))},{finally:function(e){var t=kf(this,wf("Promise")),n=bf(e);return this.then(n?function(n){return Ef(t,e()).then((function(){return n}))}:e,n?function(n){return Ef(t,e()).then((function(){throw n}))}:e)}}),bf(gf)){var Tf=wf("Promise").prototype.finally;Of.finally!==Tf&&Sf(Of,"finally",Tf,{unsafe:!0})}var xf=L,Cf=tr,Lf=Ji,Pf=D,If=xf("".charAt),jf=xf("".charCodeAt),Rf=xf("".slice),Af=function(e){return function(t,n){var r,i,o=Lf(Pf(t)),s=Cf(n),a=o.length;return s<0||s>=a?e?"":void 0:(r=jf(o,s))<55296||r>56319||s+1===a||(i=jf(o,s+1))<56320||i>57343?e?If(o,s):r:e?Rf(o,s,s+2):i-56320+(r-55296<<10)+65536}},Vf={codeAt:Af(!1),charAt:Af(!0)}.charAt,Nf=Ji,_f=Rn,Df=dc,Mf=pc,Uf="String Iterator",qf=_f.set,Hf=_f.getterFor(Uf);Df(String,"String",(function(e){qf(this,{type:Uf,string:Nf(e),index:0})}),(function(){var e,t=Hf(this),n=t.string,r=t.index;return r>=n.length?Mf(void 0,!0):(e=Vf(n,r),t.index+=e.length,Mf(e,!1))})),ns.Promise;var Ff=yt("span").classList,Qf=Ff&&Ff.constructor&&Ff.constructor.prototype,Bf=Qf===Object.prototype?void 0:Qf,zf=n,Wf={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},Gf=Bf,Xf=xc,Jf=Jt,Kf=it,Yf=Kf("iterator"),$f=Kf("toStringTag"),Zf=Xf.values,ed=function(e,t){if(e){if(e[Yf]!==Zf)try{Jf(e,Yf,Zf)}catch(t){e[Yf]=Zf}if(e[$f]||Jf(e,$f,t),Wf[t])for(var n in Xf)if(e[n]!==Xf[n])try{Jf(e,n,Xf[n])}catch(t){e[n]=Xf[n]}}};for(var td in Wf)ed(zf[td]&&zf[td].prototype,td);ed(Gf,"DOMTokenList");function nd(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function rd(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?nd(Object(n),!0).forEach((function(t){hd(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nd(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function id(e){return id="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},id(e)}function od(e,t,n,r,i,o,s){try{var a=e[o](s),c=a.value}catch(e){return void n(e)}a.done?t(c):Promise.resolve(c).then(r,i)}function sd(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function s(e){od(o,r,i,s,a,"next",e)}function a(e){od(o,r,i,s,a,"throw",e)}s(void 0)}))}}function ad(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cd(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ud(e,t,n){return t&&cd(e.prototype,t),n&&cd(e,n),e}function hd(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ld(e){return function(e){if(Array.isArray(e))return fd(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return fd(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return fd(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function fd(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}!function(e){var t=function(e){var t,n=Object.prototype,r=n.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var i=t&&t.prototype instanceof m?t:m,o=Object.create(i.prototype),s=new L(r||[]);return o._invoke=function(e,t,n){var r=l;return function(i,o){if(r===d)throw new Error("Generator is already running");if(r===p){if("throw"===i)throw o;return I()}for(n.method=i,n.arg=o;;){var s=n.delegate;if(s){var a=T(s,n);if(a){if(a===v)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===l)throw r=p,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=d;var c=h(e,t,n);if("normal"===c.type){if(r=n.done?p:f,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r=p,n.method="throw",n.arg=c.arg)}}}(e,n,s),o}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=u;var l="suspendedStart",f="suspendedYield",d="executing",p="completed",v={};function m(){}function g(){}function y(){}var w={};c(w,o,(function(){return this}));var b=Object.getPrototypeOf,k=b&&b(b(P([])));k&&k!==n&&r.call(k,o)&&(w=k);var E=y.prototype=m.prototype=Object.create(w);function S(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function O(e,t){function n(i,o,s,a){var c=h(e[i],e,o);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==typeof l&&r.call(l,"__await")?t.resolve(l.__await).then((function(e){n("next",e,s,a)}),(function(e){n("throw",e,s,a)})):t.resolve(l).then((function(e){u.value=e,s(u)}),(function(e){return n("throw",e,s,a)}))}a(c.arg)}var i;this._invoke=function(e,r){function o(){return new t((function(t,i){n(e,r,t,i)}))}return i=i?i.then(o,o):o()}}function T(e,n){var r=e.iterator[n.method];if(r===t){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=t,T(e,n),"throw"===n.method))return v;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var i=h(r,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,v;var o=i.arg;return o?o.done?(n[e.resultName]=o.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,v):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function x(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function L(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(x,this),this.reset(!0)}function P(e){if(e){var n=e[o];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,s=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return s.next=s}}return{next:I}}function I(){return{value:t,done:!0}}return g.prototype=y,c(E,"constructor",y),c(y,"constructor",g),g.displayName=c(y,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,c(e,a,"GeneratorFunction")),e.prototype=Object.create(E),e},e.awrap=function(e){return{__await:e}},S(O.prototype),c(O.prototype,s,(function(){return this})),e.AsyncIterator=O,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var s=new O(u(t,n,r,i),o);return e.isGeneratorFunction(n)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},S(E),c(E,a,"Generator"),c(E,o,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=P,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(C),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return a.type="throw",a.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var c=r.call(s,"catchLoc"),u=r.call(s,"finallyLoc");if(c&&u){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,v):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),C(n),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;C(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:P(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),v}},e}(e.exports);try{regeneratorRuntime=t}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}}({exports:{}});var dd,pd,vd,md,gd=-1,yd=function(e){addEventListener("pageshow",(function(t){t.persisted&&(gd=t.timeStamp,e(t))}),!0)},wd=function(){return window.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0]},bd=function(){var e=wd();return e&&e.activationStart||0},kd=function(e,t){var n=wd(),r="navigate";return gd>=0?r="back-forward-cache":n&&(r=document.prerendering||bd()>0?"prerender":n.type.replace(/_/g,"-")),{name:e,value:void 0===t?-1:t,rating:"good",delta:0,entries:[],id:"v3-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12),navigationType:r}},Ed=function(e,t,n){try{if(PerformanceObserver.supportedEntryTypes.includes(e)){var r=new PerformanceObserver((function(e){t(e.getEntries())}));return r.observe(Object.assign({type:e,buffered:!0},n||{})),r}}catch(e){}},Sd=function(e,t){var n=function n(r){"pagehide"!==r.type&&"hidden"!==document.visibilityState||(e(r),t&&(removeEventListener("visibilitychange",n,!0),removeEventListener("pagehide",n,!0)))};addEventListener("visibilitychange",n,!0),addEventListener("pagehide",n,!0)},Od=function(e,t,n,r){var i,o;return function(s){t.value>=0&&(s||r)&&((o=t.value-(i||0))||void 0===i)&&(i=t.value,t.delta=o,t.rating=function(e,t){return e>t[1]?"poor":e>t[0]?"needs-improvement":"good"}(t.value,n),e(t))}},Td=-1,xd=function(){return"hidden"!==document.visibilityState||document.prerendering?1/0:0},Cd=function(){Sd((function(e){var t=e.timeStamp;Td=t}),!0)},Ld=function(){return Td<0&&(Td=xd(),Cd(),yd((function(){setTimeout((function(){Td=xd(),Cd()}),0)}))),{get firstHiddenTime(){return Td}}},Pd=function(e,t){t=t||{};var n,r=[1800,3e3],i=Ld(),o=kd("FCP"),s=function(e){e.forEach((function(e){"first-contentful-paint"===e.name&&(c&&c.disconnect(),e.startTime<i.firstHiddenTime&&(o.value=Math.max(e.startTime-bd(),0),o.entries.push(e),n(!0)))}))},a=window.performance&&window.performance.getEntriesByName&&window.performance.getEntriesByName("first-contentful-paint")[0],c=a?null:Ed("paint",s);(a||c)&&(n=Od(e,o,r,t.reportAllChanges),a&&s([a]),yd((function(i){o=kd("FCP"),n=Od(e,o,r,t.reportAllChanges),requestAnimationFrame((function(){requestAnimationFrame((function(){o.value=performance.now()-i.timeStamp,n(!0)}))}))})))},Id=!1,jd=-1,Rd=function(e,t){t=t||{};var n=[.1,.25];Id||(Pd((function(e){jd=e.value})),Id=!0);var r,i=function(t){jd>-1&&e(t)},o=kd("CLS",0),s=0,a=[],c=function(e){e.forEach((function(e){if(!e.hadRecentInput){var t=a[0],n=a[a.length-1];s&&e.startTime-n.startTime<1e3&&e.startTime-t.startTime<5e3?(s+=e.value,a.push(e)):(s=e.value,a=[e]),s>o.value&&(o.value=s,o.entries=a,r())}}))},u=Ed("layout-shift",c);u&&(r=Od(i,o,n,t.reportAllChanges),Sd((function(){c(u.takeRecords()),r(!0)})),yd((function(){s=0,jd=-1,o=kd("CLS",0),r=Od(i,o,n,t.reportAllChanges)})))},Ad={passive:!0,capture:!0},Vd=new Date,Nd=function(e,t){dd||(dd=t,pd=e,vd=new Date,Md(removeEventListener),_d())},_d=function(){if(pd>=0&&pd<vd-Vd){var e={entryType:"first-input",name:dd.type,target:dd.target,cancelable:dd.cancelable,startTime:dd.timeStamp,processingStart:dd.timeStamp+pd};md.forEach((function(t){t(e)})),md=[]}},Dd=function(e){if(e.cancelable){var t=(e.timeStamp>1e12?new Date:performance.now())-e.timeStamp;"pointerdown"==e.type?function(e,t){var n=function(){Nd(e,t),i()},r=function(){i()},i=function(){removeEventListener("pointerup",n,Ad),removeEventListener("pointercancel",r,Ad)};addEventListener("pointerup",n,Ad),addEventListener("pointercancel",r,Ad)}(t,e):Nd(t,e)}},Md=function(e){["mousedown","keydown","touchstart","pointerdown"].forEach((function(t){return e(t,Dd,Ad)}))},Ud=function(e,t){t=t||{};var n,r=[100,300],i=Ld(),o=kd("FID"),s=function(e){e.startTime<i.firstHiddenTime&&(o.value=e.processingStart-e.startTime,o.entries.push(e),n(!0))},a=function(e){e.forEach(s)},c=Ed("first-input",a);n=Od(e,o,r,t.reportAllChanges),c&&Sd((function(){a(c.takeRecords()),c.disconnect()}),!0),c&&yd((function(){var i;o=kd("FID"),n=Od(e,o,r,t.reportAllChanges),md=[],pd=-1,dd=null,Md(addEventListener),i=s,md.push(i),_d()}))},qd={},Hd=function(e,t){t=t||{};var n,r=[2500,4e3],i=Ld(),o=kd("LCP"),s=function(e){var t=e[e.length-1];if(t){var r=Math.max(t.startTime-bd(),0);r<i.firstHiddenTime&&(o.value=r,o.entries=[t],n())}},a=Ed("largest-contentful-paint",s);if(a){n=Od(e,o,r,t.reportAllChanges);var c=function(){qd[o.id]||(s(a.takeRecords()),a.disconnect(),qd[o.id]=!0,n(!0))};["keydown","click"].forEach((function(e){addEventListener(e,c,{once:!0,capture:!0})})),Sd(c,!0),yd((function(i){o=kd("LCP"),n=Od(e,o,r,t.reportAllChanges),requestAnimationFrame((function(){requestAnimationFrame((function(){o.value=performance.now()-i.timeStamp,qd[o.id]=!0,n(!0)}))}))}))}},Fd=function e(t){document.prerendering?addEventListener("prerenderingchange",(function(){return e(t)}),!0):"complete"!==document.readyState?addEventListener("load",(function(){return e(t)}),!0):setTimeout(t,0)},Qd=function(e,t){t=t||{};var n=[800,1800],r=kd("TTFB"),i=Od(e,r,n,t.reportAllChanges);Fd((function(){var o=wd();if(o){if(r.value=Math.max(o.responseStart-bd(),0),r.value<0||r.value>performance.now())return;r.entries=[o],i(!0),yd((function(){r=kd("TTFB",0),(i=Od(e,r,n,t.reportAllChanges))(!0)}))}}))};function Bd(e){var t=[];if(void 0!==e.options)for(var n=0;n<e.options.length;n+=1)e.options[n].selected&&t.push(e.options[n].value);return t.join(", ")}function zd(){var e=(new Date).getTime(),t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)}));return t}function Wd(){return Math.floor((new Date).getTime()/1e3)}var Gd=0;function Xd(){var e=(new Date).getTime();return Gd>=e?Gd+=1:Gd=e,Gd}function Jd(e){var t=[];if("object"===id(e)&&null!==e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push("".concat(n,"=").concat(encodeURIComponent(e[n])));return t.join("&")}function Kd(e,t){for(var n,r={},i=0;i<t.length;i+=1)void 0!==e[n=t[i]]&&(r[n]=e[n]);return r}function Yd(e,t,n,r){e.addEventListener?e.addEventListener(t,n,r):e.attachEvent&&e.attachEvent("on".concat(t),n)}function $d(e,t,n,r){e.removeEventListener?e.removeEventListener(t,n,r):e.detachEvent&&e.detachEvent("on".concat(t),n)}function Zd(e){return e||(e=window.event),void 0!==e.target?e.target:e.srcElement}function ep(e){return void 0===e.pageY&&"number"==typeof e.clientX&&document.documentElement&&(e.pageX=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,e.pageY=e.clientY+document.body.scrollTop+document.documentElement.scrollTop),e}function tp(){return Math.max(Math.max(document.body.scrollHeight,document.documentElement.scrollHeight),Math.max(document.body.offsetHeight,document.documentElement.offsetHeight),Math.max(document.body.clientHeight,document.documentElement.clientHeight))}function np(){return Math.max(Math.max(document.body.scrollWidth,document.documentElement.scrollWidth),Math.max(document.body.offsetWidth,document.documentElement.offsetWidth),Math.max(document.body.clientWidth,document.documentElement.clientWidth))}function rp(e,t){if(function(e){return"object"===id(e)&&null!==e&&1===e.nodeType}(e)&&t){if(e.closest)return e.closest(t);for(var n=e.matches||e.webkitMatchesSelector||e.mozMatchesSelector||e.oMatchesSelector||e.msMatchesSelector;e;){if(n.call(e,t))return e;e=e.parentElement}}return null}function ip(e){if(e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!0;return!1}function op(e,t){!function(e,t,n,r,i,o){var s=document.createElement(e),a=!1;s.setAttribute(t,n),s.setAttribute(r,i),o&&(s.onload=function(){a||o(),a=!0},s.onreadystatechange=s.onload),document.getElementsByTagName("head")[0].appendChild(s)}("script","type","text/javascript","src",e,t)}function sp(){var e=document.getElementById("ha-loader");if(!e){var t="#ha-loader {height: 4px; width: 100%; position: absolute; z-index: 99999; overflow: hidden; background-color: #fff; top:0px; left:0px;}#ha-loader:before{display: block; position: absolute; content: ''; left: -200px; width: 200px; height: 4px; background-color: #2EB52B; animation: ha-loading 2s linear infinite;}@keyframes ha-loading { from {left: -200px; width: 30%;} 50% {width: 30%;} 70% {width: 70%;} 80% { left: 50%;} 95% {left: 120%;} to {left: 100%;}}",n=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.styleSheet?r.styleSheet.cssText=t:r.appendChild(document.createTextNode(t)),n.appendChild(r),(e=document.createElement("div")).setAttribute("id","ha-loader"),document.body.appendChild(e)}e.style.display="block"}function ap(){var e=document.getElementById("ha-loader");e&&(e.style.display="none")}function cp(){var e=navigator.userAgent.toLowerCase()||"",t=navigator.appVersion.toLowerCase()||"";if(/win/i.test(t)){return{os:"windows",osVersion:e.indexOf("Windows nt 5.0")>-1||e.indexOf("Windows 2000")>-1?"2000":e.indexOf("Windows nt 5.1")>-1||e.indexOf("Windows XP")>-1?"XP":e.indexOf("Windows nt 5.2")>-1||e.indexOf("Windows 2003")>-1?"2003":e.indexOf("Windows nt 6.0")>-1||e.indexOf("Windows Vista")>-1?"Vista":e.indexOf("Windows nt 6.1")>-1||e.indexOf("Windows 7")>-1?"7":e.indexOf("windows nt 6.2")>-1||e.indexOf("Windows 8")>-1?"8":e.indexOf("windows nt 10.0")>-1||e.indexOf("Windows 10")>-1?"10":"其他"}}if(/iphone/i.test(e)||/ipad/i.test(e)){return{os:"ios",osVersion:function(){if(e.indexOf("like mac os")>0){var t=e.match(/os [\d._]+/gi);return"".concat(t).replace(/[^0-9|_.]/gi,"").replace(/_/gi,".")}return"其他"}()}}return/android/i.test(e)?{os:"android",osVersion:(e.match(/android (.*?);/)||[])[1]}:/mac/i.test(t)?{os:"MacOSX",osVersion:navigator.platform}:{os:"Unkonwn",osVersion:"Unkonwn"}}function up(e){var t=[];return e?-1===e.indexOf(",")?(t.push(e),t):t=e.split(","):[]}function hp(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function lp(e,t){"string"!=typeof e&&(e="function"==typeof e&&"function"==typeof e.toString?e.toString():JSON.stringify(e));if(!e||!t)return"null";for(var n=0,r=0,i=0;i<e.length;i+=1)n+=e[i].charCodeAt();for(var o=0;o<t.length;o+=1)r+=t[o].charCodeAt();var s="".concat(n).concat(t[t.length-1].charCodeAt()).concat(r).concat(e[e.length-1].charCodeAt());return s&&(s+="ABCDEFGHJKMNPQRSTWXYZ"[s[s.length-1]]),s}function fp(e,t){this[t]&&(e[t]=this[t])}function dp(e){return e.includes("http")&&e.includes("https")||("/"!==e.charAt(0)&&(e="/".concat(e)),e=window.location.origin+e),e}var pp=function(){function e(t){ad(this,e),this.hasSendObj=Object.create(null),this.pendingObj=[],this.sendedQueue=[],this.lastQueueLen=0,this.ignoreList=["huap-collect"],this.whiteListEntryType=["navigation","resource"],this.usePoll=!1,this.maxSendLen=50,this.maxRetryTime=30,this.currentRetryTime=0,this.lastViewUrl="",this.ha=t}return ud(e,[{key:"autoTrackPerformance",value:function(){this.lastViewUrl=this.ha.getViewUrl(),window.PerformanceObserver?this.initPerformanceObserver():this.usePoll=!0,this.initWebVitals(),this.getNavigationTimingSource()}},{key:"trackSpaPageView",value:function(e){var t=this,n=+new Date;"function"==typeof e.beforeEach&&"function"==typeof e.afterEach&&(e.beforeEach((function(e,t,r){n=+new Date,r()})),e.afterEach((function(){t.lastViewUrl&&t.lastViewUrl!==t.ha.getViewUrl()&&(t.handleNewPageUnId(),t.sendEvent({ready:(+new Date-n).toString()}))})))}},{key:"isIgnore",value:function(e){return this.ignoreList.find((function(t){if(!(t.indexOf(e.name)>=0||e.name.indexOf(t)>=0))return t}))}},{key:"getIgnoreList",value:function(){var e=this;return window.performance.getEntries().filter((function(t){return"initiatorType"in t&&"xmlhttprequest"===t.initiatorType&&e.isIgnore(t)||"initiatorType"in t&&"xmlhttprequest"!==t.initiatorType}))}},{key:"handleNewPageUnId",value:function(){if(this.lastViewUrl&&this.lastViewUrl!==this.ha.getViewUrl()){var e=zd();return this.ha.pageUnId=e,this.lastViewUrl=this.ha.getViewUrl(),e}return""}},{key:"initPerformanceObserver",value:function(){var e=this;this.handleNewQueue("high"),new PerformanceObserver((function(t){e.handleNewPageUnId();for(var n=[],r=t.getEntries(),i=function(t){var i=r[t];"initiatorType"in i&&e.whiteListEntryType.includes(i.entryType)&&e.ignoreList.forEach((function(e){e.includes(i.name)||i.name.includes(e)||n.push(i)}))},o=0;o<r.length;o+=1)i(o);n.length&&(e.ha.log("new add performance queue",n),e.sendEvent({length:n.length,segmentation:{performances:n}}))})).observe({entryTypes:(null===PerformanceObserver||void 0===PerformanceObserver?void 0:PerformanceObserver.supportedEntryTypes)||["navigation","resource","largest-contentful-paint","layout-shift","paint"]})}},{key:"sendEvent",value:function(e){var t,n={title:document.title,view:window.location.href};e.segmentation?e.segmentation=rd(rd({},e.segmentation),n):e.segmentation=rd({},n),e.segmentation.supportCookie=(null===(t=window.navigator)||void 0===t?void 0:t.cookieEnabled)?"1":"0",this.ha.addHaEvents(rd({key:"performance",pageUnId:this.ha.pageUnId},e),!0)}},{key:"initWebVitals",value:function(){var e=this;Rd((function(t){e.sendEvent({cls:"".concat(t.value)})}),{reportAllChanges:!0}),Ud((function(t){e.sendEvent({fid:"".concat(t.value)})}),{reportAllChanges:!0}),Hd((function(t){e.sendEvent({lcp:"".concat(t.value)})}),{reportAllChanges:!0}),Pd((function(t){e.sendEvent({fcp:"".concat(t.value)})}),{reportAllChanges:!0}),Qd((function(t){e.sendEvent({ttfb:"".concat(t.value)})}),{reportAllChanges:!0})}},{key:"filterExceptionValue",value:function(e){var t=this;if("[object Object]"===Object.prototype.toString.call(e)){var n=function(n){var r=e[n],i=parseFloat(r);if("string"==typeof r&&i<=0||"string"==typeof r&&"NaN"===r)t.pendingObj.includes(n)||t.pendingObj.push(n),delete e[n];else if(i>0&&t.pendingObj.includes(n)){var o=t.pendingObj.findIndex((function(e){return e===n}));t.pendingObj.splice(o,1),t.hasSendObj[n]=r}else i>0&&!hp(t.hasSendObj,n)?t.hasSendObj[n]=r:i>0&&hp(t.hasSendObj,n)&&delete e[n]};for(var r in e)n(r)}}},{key:"handleEffluenceQueue",value:function(e,t){var n=this;this.ha.log("split queue length",e.slice(0,this.maxSendLen)),this.sendEvent({length:e.slice(0,this.maxSendLen).length,segmentation:{performances:e.slice(0,this.maxSendLen)}}),setTimeout((function(){e.slice(n.maxSendLen).length>n.maxSendLen?n.handleEffluenceQueue(e.slice(n.maxSendLen),t):e.slice(n.maxSendLen).length&&(n.sendEvent({length:e.slice(n.maxSendLen).length,segmentation:{performances:e.slice(n.maxSendLen)}}),n.ha.log("split queue length",e.slice(n.maxSendLen)))}),500)}},{key:"handleNewQueue",value:function(e){var t=this.getIgnoreList();if(this.lastQueueLen!==t.length){var n=this.getIgnoreList().slice(this.lastQueueLen,t.length);n.length>this.maxSendLen?this.handleEffluenceQueue(n,e):(this.sendEvent({length:n.length,segmentation:{performances:n}}),this.ha.log("new add performance queue",n)),this.lastQueueLen=this.getIgnoreList().length}}},{key:"handlegetNavigationResource",value:function(){var e=window.performance.getEntries()[0],t=Object.create(null);t.tti="".concat(e.domInteractive-e.fetchStart);var n=window.performance.getEntriesByName("first-paint");t.fp="".concat(n.length&&n[0].startTime||0),t.fpt="".concat(e.responseEnd-e.fetchStart),t.ready="".concat(e.domContentLoadedEventEnd-e.fetchStart),t.load="".concat(e.loadEventStart-e.fetchStart),t.trans="".concat(e.responseEnd-e.responseStart),t.dns="".concat(e.domainLookupEnd-e.domainLookupStart),t.tcp="".concat(e.connectEnd-e.connectStart),t.dom="".concat(e.domInteractive-e.responseEnd),t.res="".concat(e.loadEventStart-e.domContentLoadedEventEnd),t.ssl=e.secureConnectionStart?"".concat(e.connectEnd-e.secureConnectionStart):"0",this.filterExceptionValue(t),"{}"!==JSON.stringify(t)&&this.sendEvent(rd({},t))}},{key:"getNavigationTimingSource",value:function(){var e=this;this.currentRetryTime<=this.maxRetryTime&&this.handlegetNavigationResource(),this.currentRetryTime+=1,this.usePoll&&(this.handleNewPageUnId(),this.handleNewQueue("low")),setTimeout((function(){e.getNavigationTimingSource()}),200)}}]),e}(),vp=function(){function e(t){ad(this,e),this.trackingCrashes=!1,this.ignoreList=["huap-collect","/sockjs-node"],this.lastViewUrl="",this.errorPageUnId="",this.maxErrorObj=Object.create(null),this.TrashEvent=[[]],this.ha=t}var t;return ud(e,[{key:"autoTrackErrors",value:function(){if(!this.trackingCrashes){if(this.ha.customReply&&this.handleRecordError(),this.errorPageUnId=zd(),this.lastViewUrl=this.ha.getViewUrl(),this.trackingCrashes=!0,this.handleReWriteListener(),this.handleListenerError(),this.handleWindowError(),this.handleRejection(),this.handleLogError(),!window.XMLHttpRequest)return;this.handleXhrError()}}},{key:"handleReWriteListener",value:function(){if(window.EventTarget){var e=EventTarget.prototype.addEventListener;EventTarget.prototype.addEventListener=function(t,n,r){return e.call(this,t,"object"===id(n)?n:function e(){try{if("function"!=typeof n)return;return this.EventTargetWrappedListener=e,n.apply(this,arguments)}catch(e){throw e}},r)};var t=EventTarget.prototype.removeEventListener;EventTarget.prototype.removeEventListener=function(e,n,r){return this&&this.EventTargetWrappedListener&&t.call(this,e,this.EventTargetWrappedListener,r),t.call(this,e,n,r)}}}},{key:"handlePromiseCatch",value:function(){var e=Promise.prototype.catch,t=this;Promise.prototype.catch=function(n){return t.dispatchErrors(n,"PromiseCatch"),e.apply(this,n),this}}},{key:"trackVueError",value:function(e){var t,n,r=this;e.version.includes("2.")&&"function"==typeof e&&null===(null===(t=e.config)||void 0===t?void 0:t.errorHandler)?e.config.errorHandler=function(e){r.dispatchErrors(e,"Vue2Error")}:e.version.includes("3.")&&"object"===id(e)&&void 0===(null===(n=e.config)||void 0===n?void 0:n.errorHandler)&&(e.config.errorHandler=function(e){r.dispatchErrors(e,"Vue3Error")})}},{key:"handleFilterBlackList",value:function(e){return!!this.ignoreList.concat(this.ha.ignoreList).find((function(t){return e.includes(t)}))}},{key:"handleXhrError",value:function(){var e=window.XMLHttpRequest,t=e.prototype.open,n=this;e.prototype.open=function(e,r){return n.handleFilterBlackList(r)||(r=dp(r),this.logData={method:e,url:r}),t.apply(this,arguments)};var r=e.prototype.send;e.prototype.send=function(e){var t=this;if(hp(this,"logData")){var i=function(r){return function(){var i=t.logData,o="\nmethod：".concat(i.method,"\n");o+="url：".concat(i.url,"\n"),o+="status：".concat(t.status,"\n"),o+="body：".concat(e||"","\n"),o+="response：".concat(t.response),n.dispatchErrors(new Error("".concat(o)),"Xhr".concat(r.replace(r[0],r[0].toUpperCase())),"JavaScript",{url:i.url})}},o=function(){(4===t.readyState&&t.status<200||4===t.readyState&&t.status>=400)&&i("error")()};this.addEventListener("readystatechange",o,!1),this.addEventListener("abort",i("abort"),!1),this.addEventListener("timeout",i("timeout"),!1)}return r.apply(this,arguments)}}},{key:"handleListenerError",value:function(){var e=this;Yd(window,"error",(function(t){var n=t.target||t.srcElement;if(n instanceof HTMLScriptElement||n instanceof HTMLLinkElement||n instanceof HTMLImageElement){var r=(n||n).src||n.href;e.dispatchErrors(new Error("Failed to Load Resource ".concat(r)),"ResourceError")}}),!0)}},{key:"handleLogError",value:function(){var e=this;if("undefined"!=typeof console){var t=console.error;console.error=function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];var o=JSON.parse(JSON.stringify(r));r.forEach((function(e,t){"[object Object]"===Object.prototype.toString.call(e)||Array.isArray(e)?(e=JSON.stringify(e),o.splice(t,1,e)):null==e?o.splice(t,1,"".concat(e)):o.splice(t,1,e)})),e.dispatchErrors(new Error("LogError ".concat(o.join(" "))),"LogError"),t.apply(e,r)}}}},{key:"handleRejection",value:function(){var e=this;Yd(window,"unhandledrejection",(function(t){var n;t.reason&&t.reason.stack&&(n="ios"!==cp().os?new Error("Uncaught (in promise) ".concat(t.reason.stack)):t.reason),e.dispatchErrors(n,"UnhandledRejection")}))}},{key:"handleErrorType",value:function(e){var t="";return e&&(t=e.split(":")[0]).includes("Uncaught ")&&(t=t.split("Uncaught ")[1]),t}},{key:"handleWindowError",value:function(){var e=arguments,t=this;window.onerror=function(n,r,i,o,s){var a=t.handleErrorType(n);if(void 0!==s)t.dispatchErrors(s,a);else{o=o||window.event&&window.event.errorCharacter;var c="";void 0!==n&&(c+="".concat(n,"\n")),void 0!==r&&(c+="at ".concat(r)),void 0!==i&&(c+=":".concat(i)),void 0!==o&&(c+=":".concat(o)),c+="\n";try{for(var u=[],h=e.callee.caller;h;)u.push(h.name),h=h.caller;c+=u.join("\n")}catch(e){}t.dispatchErrors(new Error(c),a)}}}},{key:"recordError",value:function(e,t,n,r){var i,o=this;if(e){var s="",a="";"object"===id(e)?void 0!==e.stack?("ios"!==cp().os||void 0===e.message||e.message.includes("status")&&e.message.includes("body")&&e.message.includes("response")||(s+="".concat(e.message,"\n")),s+="".concat(e.stack),a=lp(e.stack,"1")):(void 0!==e.name&&(s+="".concat(e.name,":")),void 0!==e.message&&(s+="".concat(e.message,"\n")),void 0!==e.fileName&&(s+="in ".concat(e.fileName,"\n")),void 0!==e.lineNumber?s+="on ".concat(e.lineNumber):e.lineNumber=0,void 0!==e.columnNumber?s+=":".concat(e.columnNumber):e.columnNumber=0,a=lp(e.message,e.lineNumber+e.columnNumber||"1")):(s="".concat(e),a=lp(e,"1")),t||(t="");var c=rd(rd({errorStack:s,language:n||"JavaScript",view:this.ha.getViewUrl(),title:document.title,type:t||"Unknown"},r),{},{supportCookie:(null===(i=window.navigator)||void 0===i?void 0:i.cookieEnabled)?"1":"0"});if(this.ha.cypressTest&&(this.createDom("errorUnId",a),this.createDom("stack",s),this.createDom("type",t)),this.handleNewPageUnId(),this.ha.customReply){if(this.maxErrorObj[a]?this.maxErrorObj[a]+=1:this.maxErrorObj[a]=1,this.maxErrorObj[a]>this.ha.maxErrorTime)return;var u,h=this.TrashEvent.length,l=0;h>=2?(u=this.TrashEvent[h-2].concat(this.TrashEvent[h-1]),l=h-1):(l=0,u=this.TrashEvent[0]),this.TrashEvent.forEach((function(e,t){t<=l-1&&(e=[],o.TrashEvent.splice(t,1,e))}));var f=new CustomEvent("errorEvent",{detail:{url:this.ha.getViewUrl(),time:Wd(),errorStack:s,errorCode:u,title:document.title,type:t||"Unknown"}});document.dispatchEvent(f)}this.ha.addHaEvents({key:"error",errorUnId:a,errorPageUnId:this.errorPageUnId,segmentation:c},!0)}}},{key:"createDom",value:function(e,t){var n=document.createElement("div");n.className=e,n.innerText=t;var r=document.getElementById("error");r&&r.append(n)}},{key:"dispatchErrors",value:function(e,t,n,r){this.trackingCrashes&&this.recordError(e,t,n,r)}},{key:"sendError",value:function(e,t,n){var r=e instanceof Error?e:new Error(e);this.dispatchErrors(r,"CustomError",t,n)}},{key:"handleNewPageUnId",value:function(){return this.lastViewUrl&&this.lastViewUrl!==this.ha.getViewUrl()&&(this.errorPageUnId=zd(),this.lastViewUrl=this.ha.getViewUrl()),""}},{key:"handleRecordError",value:(t=sd(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(window.rrweb){e.next=2;break}return e.abrupt("return");case 2:window.rrweb.record({emit:function(e,n){n&&t.TrashEvent.push([]),t.TrashEvent[t.TrashEvent.length-1].push(e)},sampling:{mousemove:!1,mouseInteraction:!1,scroll:150,media:800,input:"last",canvas:15},packFn:window.rrweb.pack,dataURLOptions:{type:"image/webp",quality:.6},checkoutEveryNms:3e4,recordCanvas:!0,inlineImages:!0,recordCrossOriginIframes:!0});case 3:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)})}]),e}();function mp(e){var t={};function n(n,r,i){e.checkConsent("users")&&(t[n]||(t[n]={}),"$push"===i||"$pull"===i||"$addToSet"===i?(t[n][i]||(t[n][i]=[]),t[n][i].push(r)):t[n][i]=r)}return{set:function(e,n){t[e]=n},unset:function(e){t[e]=""},setOnce:function(e,t){n(e,t,"$setOnce")},increment:function(e){n(e,1,"$inc")},incrementBy:function(e,t){n(e,t,"$inc")},multiply:function(e,t){n(e,t,"$mul")},max:function(e,t){n(e,t,"$max")},min:function(e,t){n(e,t,"$min")},push:function(e,t){n(e,t,"$push")},pushUnique:function(e,t){n(e,t,"$addToSet")},pull:function(e,t){n(e,t,"$pull")},save:function(){e.checkConsent("users")&&e.toRequestQueue({userDetails:JSON.stringify({custom:t})}),t={}}}}var gp=/^(((([^:/#?]+:)?(?:(\/\/)((?:(([^:@/#?]+)(?::([^:@/#?]+))?)@)?(([^:/#?\][]+|\[[^/\]@#?]+\])(?::([0-9]+))?))?)?)?((\/?(?:[^/?#]+\/+)*)([^?#]*)))?(\?[^#]+)?)(#.*)?/,yp=/(HiAnalyticsSiteBot|nuhk|Googlebot|GoogleSecurityScanner|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|iaArchiver|bingbot|Google Web Preview|Mediapartners-Google|AdsBot-Google|Baiduspider|Ezooms|YahooSeeker|AltaVista|AVSearch|Mercator|Scooter|InfoSeek|Ultraseek|Lycos|Wget|YandexBot|Yandex|YaDirectFetcher|SiteBot|Exabot|AhrefsBot|MJ12bot|TurnitinBot|magpie-crawler|Nutch Crawler|CMS Crawler|rogerbot|Domnutch|ssearchBot|XoviBot|netseer|digincore|fr-crawler|wesee|AliasIO|contxbot|PingdomBot|BingPreview|HeadlessChrome)/,wp=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};ad(this,e),this.appKey="",this.secretKey="",this.env="tst",this.deviceId="",this.sessionId="",this.url="",this.appVersion="",this.countryCode="",this.city="",this.ipAddress="",this.debug=!1,this.ignoreBots=!0,this.interval=500,this.queueSize=1e3,this.failTimeout=60,this.inactivityTime=20,this.sessionUpdate=60,this.maxEvents=10,this.maxLogs=100,this.ignoreReferrers=[],this.ignorePrefetch=!0,this.forcePost=!1,this.ignoreVisitor=!1,this.requireConsent=!1,this.features=["sessions","events","views","scrolls","clicks","forms","crashes","attribution","users","star-rating","location","apm","remote-config"],this.utm={source:!0,medium:!0,campaign:!0,term:!0,content:!0},this.useSessionCookie=!0,this.useLocalStorageCookie=!0,this.sessionCookieTimeout=480,this.remoteConfig=!1,this.namespace="",this.trackDomains=!0,this.metrics={},this.headers={},this.storage="default",this.clickData=[],this.heartMapLocalDebug=!1,this.q=[],this.onload=[],this.serialize=e.serialize,this.deserialize=e.deserialize,this.getViewName=e.getViewName,this.getViewUrl=e.getViewUrl,this.trackSpaPageView=function(){},this.sendError=function(){},this.trackVueError=function(){},this.ready=function(){},this.global=!0,this.sessionStarted=!1,this.apiPath="/collect",this.readPath="",this.beatInterval=500,this.requestQueue=[],this.eventQueue=[],this.remoteConfigs={},this.crashLogs=[],this.timedEvents={},this.autoExtend=!0,this.lastBeat=Wd(),this.storedDuration=0,this.lastView=null,this.lastTitle=null,this.lastViewTime=0,this.lastViewUrl=null,this.lastViewStoredDuration=0,this.failTimeoutAmount=60,this.inactivityCounter=0,this.maxEventBatch=10,this.maxCrashLogs=100,this.readyToProcess=!0,this.hasPulse=!1,this.offlineMode=!1,this.syncConsents={},this.lastParams={},this.trackTime=!0,this.startTimestamp=Wd(),this.localStorageSupport=!0,this.consents={},this.testMode=!1,this.passedData=null,this.platform="",this.consentTimer=null,this.heartBeatTimer=null,this.showHeatMap=!0,this.heatMapUrls=[],this.onWindowResize=null,this.useVueRouter=!1,this.cypressTest=!1,this.performanceInfo=Object.create(null),this.errorInfo=Object.create(null),this.pageUnId="",this.processInstId="",this.processName="",this.processUrl="",this.processVersion="",this.processId="",this.systemId="",this.visitTime=0,this.customReply=!1,this.ignoreList=[],this.maxErrorTime=3,this.pageUnId=zd(),this.global=0===Object.keys(e.i).length,Object.keys(n).forEach((function(e){t[e]=n[e]}));try{localStorage.setItem("ha_test_local","true"),localStorage.removeItem("ha_test_local")}catch(e){this.localStorageSupport=!1}if("cookie"===this.storage&&(this.localStorageSupport=!1),this.features)for(var r=0;r<this.features.length;r+=1)this.consents[this.features[r]]={};if(!this.url){var i={tst:"https://huap-collect-tst.hikvision.com",uat:"https://huap-collect-uat.hikvision.com",prd:"https://huap-collect.hikvision.com"};i.test=i.tst,i.prod=i.prd,i.production=i.prd;var o=this.env||this.developmentModel;this.url=i[o||"tst"]}if(Array.isArray(this.ignoreReferrers)||(this.ignoreReferrers=[]),""===this.url&&(this.log("Please provide server URL"),this.ignoreVisitor=!0),this.store("ha_ignore")&&(this.ignoreVisitor=!0),this.offlineMode||this.deviceId||(this.deviceId=this.getId()),this.offlineMode||this.sessionId||(this.sessionId=this.getSessionId()),this.userData=mp(this),this.requestQueue=this.store("ha_queue")||[],this.eventQueue=this.store("ha_event")||[],this.remoteConfigs=this.store("ha_remote_configs")||{},this.checkIgnore(),window.name&&0===window.name.indexOf("ha:"))try{this.passedData=JSON.parse(window.name.replace("ha:",""))}catch(e){this.log("Could not parse name",window.name)}else if(window.location.hash&&0===window.location.hash.indexOf("#ha:"))try{this.passedData=JSON.parse(window.location.hash.replace("#ha:",""))}catch(e){this.log("Could not parse hash",window.location.hash)}(this.passedData&&this.passedData.appKey&&this.passedData.appKey===this.appKey||this.passedData&&!this.passedData.appKey&&this.global)&&this.passedData.token&&this.passedData.purpose&&(this.passedData.token!==this.store("ha_old_token")&&(this.setToken(this.passedData.token),this.store("ha_old_token",this.passedData.token)),"heatmap"===this.passedData.purpose&&(this.ignoreVisitor=!0,sp(),op("".concat(this.url,"/views/heatmap.js"),ap)));var s=this;this.checkEnable((function(e){s.sessionCookieTimeout=+e.sessionDuration,"1"===e.enable&&(t.isSessionExpired()&&(t.sessionId=zd()),t.initialize()),t.showHeatMap="1"===e.heatMapEnable&&!!e.heatMapUrls,t.showHeatMap&&void 0!==e.heatMapUrls&&(t.heatMapUrls=up(e.heatMapUrls),n.domain?document.domain=n.domain:window.location.hostname.indexOf("hikvision.com")>-1&&(document.domain="hikvision.com")),"1"===e.performanceEnable&&(t.performanceInfo=new pp(t),t.performanceInfo.autoTrackPerformance(),t.trackSpaPageView=t.performanceInfo.trackSpaPageView.bind(Object.assign(t.performanceInfo))),"1"===e.errorEnable&&(t.errorInfo=new vp(t),t.errorInfo.autoTrackErrors(),t.sendError=t.errorInfo.sendError.bind(t.errorInfo),t.trackVueError=t.errorInfo.trackVueError.bind(t.errorInfo)),"function"==typeof t.ready&&t.ready()}))}var t,n;return ud(e,[{key:"initialize",value:function(){var e=this;if(!this.ignoreVisitor){if(this.log("HiAnalytics initialized"),window.location.search){for(var t=window.location.search.substring(1).split("&"),n={},r=!1,i=0;i<t.length;i+=1){var o=t[i].split("=");"ha_id"===o[0]?this.store("ha_cmp_id",o[1]):"ha_uid"===o[0]?this.store("ha_cmp_uid",o[1]):"ha_device_id"===o[0]?this.deviceId=o[1]:"ha_session_id"===o[0]?this.sessionId=o[1]:0==="".concat(o[0]).indexOf("utm_")&&this.utm[o[0].replace("utm_","")]&&(n[o[0].replace("utm_","")]=o[1],r=!0)}if(r){for(var s in this.utm)n[s]?this.userData.set("utm_".concat(s),n[s]):this.userData.unset("utm_".concat(s));this.userData.save()}}this.offlineMode||(this.deviceId!==this.store("ha_id")&&this.store("ha_id",this.deviceId),this.sessionId!==this.store("ha_session_id")&&this.store("ha_session_id",this.sessionId)),this.notifyLoaders(),setTimeout((function(){e.heartBeat(),e.remoteConfig&&e.fetchRemoteConfig(e.remoteConfig)}),1)}document.documentElement.setAttribute("data-ha-useragent",navigator.userAgent),Yd(window,"storage",(function(t){if(t.key){var n=t.key.split("/"),r=n.pop(),i=n.pop();r&&i===e.appKey&&e.onStorageChange(r,t.newValue)}}))}},{key:"groupFeatures",value:function(e){if(e)for(var t in e)this.consents[t]?this.log("Feature name ".concat(t," is already reserved")):"string"==typeof e[t]?this.consents[t]={features:[e[t]]}:e[t]&&Array.isArray(e[t])&&e[t].length?this.consents[t]={features:e[t]}:this.log("Incorrect feature list for ".concat(t," value: ").concat(e[t]));else this.log("Incorrect features: ".concat(e))}},{key:"checkConsent",value:function(e){return!this.requireConsent||(this.consents[e]?!(!this.consents[e]||!this.consents[e].optin):(this.log("No feature available for ".concat(e)),!1))}},{key:"checkAnyConsent",value:function(){if(!this.requireConsent)return!0;for(var e in this.consents)if(this.consents[e]&&this.consents[e].optin)return!0;return!1}},{key:"addConsent",value:function(e){var t=this;if(this.log("Adding consent for ".concat(e)),Array.isArray(e))for(var n=0;n<e.length;n+=1)this.addConsent(e[n]);else this.consents[e]?this.consents[e].features?(this.consents[e].optin=!0,this.addConsent(this.consents[e].features)):!0!==this.consents[e].optin&&(this.syncConsents[e]=!0,this.consents[e].optin=!0,this.updateConsent(),setTimeout((function(){"sessions"===e&&t.lastParams.beginSession?(t.beginSession(t.lastParams.beginSession),t.lastParams.beginSession=null):"views"===e&&t.lastParams.trackPageview&&(t.lastView=null,t.lastTitle=null,t.trackPageview(t.lastParams.trackPageview),t.lastParams.trackPageview=null),t.lastParams.changeId&&(t.changeId(t.lastParams.changeId),t.lastParams.changeId=null)}),1)):this.log("No feature available for ".concat(e))}},{key:"removeConsent",value:function(e){if(this.log("Removing consent for ".concat(e)),Array.isArray(e))for(var t=0;t<e.length;t+=1)this.removeConsent(e[t]);else this.consents[e]?(this.consents[e].features?this.removeConsent(this.consents[e].features):!1!==this.consents[e].optin&&(this.syncConsents[e]=!1,this.updateConsent()),this.consents[e].optin=!1):this.log("No feature available for ".concat(e))}},{key:"enableOfflineMode",value:function(){this.offlineMode=!0,this.deviceId="tempId"}},{key:"disableOfflineMode",value:function(e){this.offlineMode=!1,e&&this.deviceId!==e?(this.deviceId=e,this.store("ha_id",this.deviceId),this.log("Changing id")):(this.deviceId=this.getId(),this.deviceId!==this.store("ha_id")&&this.store("ha_id",this.deviceId));var t=!1;if(this.requestQueue.length>0)for(var n=0;n<this.requestQueue.length;n+=1)"tempId"===this.requestQueue[n].deviceId&&(this.requestQueue[n].deviceId=this.deviceId,t=!0);t&&this.store("ha_queue",this.requestQueue,!0)}},{key:"beginSession",value:(n=sd(regeneratorRuntime.mark((function e(){var t,n,r,i,o=this,s=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=s.length>0&&void 0!==s[0]&&s[0],n=s.length>1&&void 0!==s[1]&&s[1],!this.checkConsent("sessions")){e.next=21;break}if(this.sessionStarted){e.next=19;break}if(this.reportOrientation(),this.onWindowResize||(this.onWindowResize=function(){o.reportOrientation()},Yd(window,"resize",this.onWindowResize)),this.lastBeat=Wd(),this.sessionStarted=!0,this.autoExtend=!t,!n&&this.useSessionCookie&&!this.isSessionExpired()){e.next=18;break}return this.log("Session started"),(r={}).beginSession=1,e.next=15,this.getMetrics();case 15:i=e.sent,r.metrics=JSON.stringify(i),this.toRequestQueue(r);case 18:this.store("ha_session",Wd()+60*this.sessionCookieTimeout);case 19:e.next=22;break;case 21:this.lastParams.beginSession=s;case 22:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"sessionDuration",value:function(e){this.checkConsent("sessions")&&this.sessionStarted&&(this.log("Session extended",e),this.toRequestQueue({sessionDuration:e}),this.extendSession())}},{key:"endSession",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3?arguments[3]:void 0;if(this.checkConsent("sessions")&&this.sessionStarted){if(e=e||Wd()-this.lastBeat,this.reportViewDuration(),this.onWindowResize&&($d(window,"resize",this.onWindowResize),this.onWindowResize=null),!this.useSessionCookie||t){var i={endSession:1,sessionDuration:e};this.log("Ending session"),this.store("ha_session",null),this.store("ha_session_id",null),n?(this.prepareRequest(i),this.sendBeacon(this.url+this.apiPath,i,(function(){r instanceof Function&&r()}))):this.toRequestQueue(i)}else this.sessionDuration(e);this.sessionStarted=!1}}},{key:"changeId",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.deviceId!==e){t||(this.eventQueue.length>0&&(this.toRequestQueue({events:JSON.stringify(this.eventQueue)}),this.eventQueue=[],this.store("ha_event",this.eventQueue)),this.endSession(0,!0),this.timedEvents={});var n=this.deviceId;this.deviceId=e,this.store("ha_id",this.deviceId),this.log("Changing id"),t?this.checkAnyConsent()?this.toRequestQueue({oldDeviceId:n}):this.lastParams.changeId=arguments:this.beginSession(!this.autoExtend,!0),this.remoteConfig&&(this.remoteConfigs={},this.store("ha_remote_configs",this.remoteConfigs),this.fetchRemoteConfig(this.remoteConfig))}}},{key:"addClickEvent",value:function(e){e.key="click",this.addEvent(e)}},{key:"addEvent",value:function(e){e.customEventFlag=!0;var t=rd(rd({},e),{},{segmentation:rd(rd(rd({},e),e.segmentation),{},{view:this.getViewUrl(),visitTime:this.visitTime})});this.checkConsent("events")&&this.addHaEvents(t)}},{key:"addEventCallBack",value:function(e,t){e.customEventFlag=!0;var n=rd(rd({},e),{},{segmentation:rd(rd(rd({},e),e.segmentation),{},{view:this.getViewUrl(),visitTime:this.visitTime})});n.timestamp=Xd();var r=new Date;n.hour=r.getHours(),n.dow=r.getDay();var i={events:JSON.stringify([n])};this.prepareRequest(i),this.sendBeacon(this.url+this.apiPath,i,(function(){t instanceof Function&&t()}))}},{key:"startEvent",value:function(e){this.timedEvents[e]?this.log("Timed event with key ".concat(e," already started")):this.timedEvents[e]=Wd()}},{key:"endEvent",value:function(e){"string"==typeof e&&(e={key:e}),e.key?this.timedEvents[e.key]?(e.dur=Wd()-this.timedEvents[e.key],this.addEvent(e),delete this.timedEvents[e.key]):this.log("Timed event with key ".concat(e.key," was not started")):this.log("Event must have key property")}},{key:"reportOrientation",value:function(e){this.checkConsent("users")&&this.addHaEvents({key:"orientation",segmentation:{mode:e||(window.innerWidth>window.innerHeight?"landscape":"portrait")}})}},{key:"reportConversion",value:function(e,t){this.checkConsent("attribution")&&(e=e||this.store("ha_cmp_id")||"ha_organic",t=t||this.store("ha_cmp_uid"),e&&t?this.toRequestQueue({campaignId:e,campaignUser:t}):e&&this.toRequestQueue({campaignId:e}))}},{key:"userDetails",value:function(e){if(this.checkConsent("users")){this.log("Adding user details: ",e);this.toRequestQueue({userDetails:JSON.stringify(Kd(e,["name","username","email","organization","phone","picture","gender","byear","custom","tenantId"]))})}}},{key:"reportTrace",value:function(e){if(this.checkConsent("apm")){var t=Kd(e,["loadSpeed"]);t.view=this.getViewUrl(),t.timestamp=e.stz;var n=new Date;t.hour=n.getHours(),t.dow=n.getDay(),this.toRequestQueue({apm:JSON.stringify(t)}),this.log("Adding APM trace: ",t)}}},{key:"addLog",value:function(e){this.checkConsent("crashes")&&(this.crashLogs.length>this.maxCrashLogs&&this.crashLogs.shift(),this.crashLogs.push(e))}},{key:"fetchRemoteConfig",value:function(e,t,n){var r=this;if(this.checkConsent("remote-config")){var i={method:"fetchRemoteConfig"};this.checkConsent("sessions")&&(i.metrics=JSON.stringify(this.getMetrics())),e&&(n||"function"!=typeof e?Array.isArray(e)&&e.length&&(i.keys=JSON.stringify(e)):(n=e,e=void 0)),t&&(n||"function"!=typeof t?Array.isArray(t)&&t.length&&(i.omitKeys=JSON.stringify(t)):(n=t,t=[])),this.prepareRequest(i),this.sendXmlHttpRequest(this.url+this.readPath,i,(function(e,t,o){try{var s=JSON.parse(o);if(i.keys||i.omitKeys)for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(r.remoteConfigs[a]=s[a]);else r.remoteConfigs=s;r.store("ha_remote_configs",r.remoteConfigs)}catch(e){}"function"==typeof n&&n(e,r.remoteConfigs)}))}else this.log("Remote config requires explicit consent"),"function"==typeof n&&n(new Error("Remote config requires explicit consent"),this.remoteConfigs)}},{key:"getRemoteConfig",value:function(e){return void 0!==e?this.remoteConfigs[e]:this.remoteConfigs}},{key:"stopTime",value:function(){this.trackTime&&(this.trackTime=!1,this.storedDuration=Wd()-this.lastBeat,this.lastViewStoredDuration=Wd()-this.lastViewTime)}},{key:"startTime",value:function(){this.trackTime||(this.trackTime=!0,this.lastBeat=Wd()-this.storedDuration,this.lastViewTime=Wd()-this.lastViewStoredDuration,this.lastViewStoredDuration=0,this.extendSession())}},{key:"autoTrack",value:function(){this.trackSessions(),this.trackPageviews(),this.trackClicks(document)}},{key:"trackSessions",value:function(){var e=this;this.beginSession(),this.startTime(),Yd(window,"beforeunload",(function(){e.endSession()})),Yd(window,"unload",(function(){e.endSession()}));var t="hidden",n=function(){document[t]?e.stopTime():e.startTime()};t in document?Yd(document,"visibilitychange",n):(t="mozHidden")in document?Yd(document,"mozvisibilitychange",n):(t="webkitHidden")in document?Yd(document,"webkitvisibilitychange",n):(t="msHidden")in document?Yd(document,"msvisibilitychange",n):"onfocusin"in document?(Yd(window,"focusin",(function(){e.startTime()})),Yd(window,"focusout",(function(){e.stopTime()}))):(Yd(window,"focus",(function(){e.startTime()})),Yd(window,"blur",(function(){e.stopTime()})),Yd(window,"pageshow",(function(){e.startTime()})),Yd(window,"pagehide",(function(){e.stopTime()})));var r=function(){e.inactivityCounter>=e.inactivityTime&&e.startTime(),e.inactivityCounter=0};Yd(window,"mousemove",r),Yd(window,"click",r),Yd(window,"keydown",r),Yd(window,"scroll",r),setInterval((function(){e.inactivityCounter+=1,e.inactivityCounter>=e.inactivityTime&&(e.stopTime(),e.endSession(0,!0))}),6e4)}},{key:"trackPageviews",value:function(){var e=this;this.trackPageview(),this.useVueRouter||(Yd(window,"hashchange",(function(){e.trackPageview()})),Yd(window,"popstate",(function(){e.trackPageview()})))}},{key:"trackPageview",value:function(e,t,n){var r,i;if(this.visitTime=(new Date).getTime(),this.reportViewDuration(),e&&Array.isArray(e)&&(t=e,e=null),e||(e=this.getViewName()),t&&t.length)for(var o=0;o<t.length;o+=1)try{var s=new RegExp(t[o]);if(e&&s.test(e))return void this.log("Ignored:",e)}catch(e){this.log("Problem with regex",t[o])}i=this.lastViewUrl&&this.lastViewUrl===this.getViewUrl()||!this.lastViewUrl?document.referrer:this.lastViewUrl;var a={name:e,fromName:this.lastView,view:this.getViewUrl(),fromView:i,visit:1,title:document.title};if(fp.call(this,a,"processInstId"),fp.call(this,a,"processName"),fp.call(this,a,"processUrl"),fp.call(this,a,"processVersion"),fp.call(this,a,"processId"),fp.call(this,a,"systemId"),this.lastView=e,this.lastTitle=document.title,this.lastViewUrl=a.view,this.lastViewTime=Wd(),this.trackDomains&&(a.domain=window.location.hostname),void 0!==document.referrer&&document.referrer.length){var c=gp.exec(document.referrer);c&&c[11]&&c[11]!==window.location.hostname&&(a.start=1)}if(n)for(var u in n)void 0===a[u]&&(a[u]=n[u]);this.checkConsent("views")?(a.supportCookie=(null===(r=window.navigator)||void 0===r?void 0:r.cookieEnabled)?"1":"0",this.addHaEvents({key:"view",segmentation:a})):this.lastParams.trackPageview=arguments}},{key:"setOaProperty",value:function(e){if("[object Object]"===Object.prototype.toString.call(e))for(var t in e)hp(this,t)&&e[t]&&(this[t]=e[t]||"");else this.handleEmptyOaProperty()}},{key:"handleEmptyOaProperty",value:function(){this.processInstId="",this.processName="",this.processUrl="",this.processVersion="",this.processId="",this.systemId=""}},{key:"trackView",value:function(e,t,n){this.trackPageview(e,t,n)}},{key:"trackClicks",value:function(e){var t=this;e=e||document;var n=!0,r=0;Yd(e,"click",(function(e){if(r+=1,t.clickData=[],n&&(n=!1,ep(e),setTimeout((function(){n=!0}),1e3),void 0!==e.pageX&&void 0!==e.pageY)){for(var i=tp(),o=np(),s=t.getViewUrl(),a=!1,c=0,u=t.heatMapUrls.length;c<u;c+=1){var h=t.heatMapUrls[c];if(h.indexOf("*")>-1&&(h=h.replace("*",""),a=s.indexOf(h)>-1))break;if(a=s===h)break}var l=e.target,f=t.getElementPath(l,!0),d=t.getClickElementRelativeCoordinate(e),p=d.offsetX,v=d.offsetY;if(t.log("heatmap switch",!t.showHeatMap||t.showHeatMap&&!a),!t.showHeatMap||t.showHeatMap&&!a)return;if(t.checkConsent("clicks")){var m={type:"click",width:o,height:i,view:s,offsetX:p,offsetY:v,domPath:f};t.trackDomains&&(m.domain=window.location.hostname),t.addHaEvents({key:"action",segmentation:m,count:r}),r=0}}}),!0)}},{key:"trackScrolls",value:function(e){var t=this;e=e||window;var n=!0,r=0;var i=function(){if(n){n=!1;var e=tp(),i=np(),o=Math.min(Math.min(document.body.clientHeight,document.documentElement.clientHeight),Math.min(document.body.offsetHeight,document.documentElement.offsetHeight),window.innerHeight);if(t.checkConsent("scrolls")){var s={type:"scroll",y:r+o,width:i,height:e,view:t.getViewUrl()};t.trackDomains&&(s.domain=window.location.hostname),t.addHaEvents({key:"action",segmentation:s})}}};Yd(e,"scroll",(function(){r=Math.max(r,window.scrollY,document.body.scrollTop,document.documentElement.scrollTop)})),Yd(e,"beforeunload",i),Yd(e,"unload",i)}},{key:"trackLinks",value:function(e){var t=this;Yd(e=e||document,"click",(function(e){var n=rp(Zd(e),"a");n&&(ep(e),t.checkConsent("clicks")&&t.addHaEvents({key:"linkClick",segmentation:{href:n.href,text:n.innerText,id:n.id,view:t.getViewUrl()}}))}))}},{key:"trackForms",value:function(e,t){var n=this;function r(e){return e.name||e.id||e.type||e.nodeName}Yd(e=e||document,"submit",(function(e){var i,o=Zd(e),s={id:o.attributes.id&&o.attributes.id.nodeValue,name:o.attributes.name&&o.attributes.name.nodeValue,action:o.attributes.action&&o.attributes.action.nodeValue,method:o.attributes.method&&o.attributes.method.nodeValue,view:n.getViewUrl()};if(void 0!==o.elements){for(var a=0;a<o.elements.length;a+=1)(i=o.elements[a])&&"password"!==i.type&&-1===i.className.indexOf("ha-user-ignore")&&(void 0===s["input:".concat(r(i))]&&(s["input:".concat(r(i))]=[]),"select"===i.nodeName.toLowerCase()?void 0!==i.multiple?s["input:".concat(r(i))].push(Bd(i)):s["input:".concat(r(i))].push(i.options[i.selectedIndex].value):"input"===i.nodeName.toLowerCase()?void 0!==i.type?"checkbox"===i.type.toLowerCase()||"radio"===i.type.toLowerCase()?i.checked&&s["input:".concat(r(i))].push(i.value):("hidden"!==i.type.toLowerCase()||t)&&s["input:".concat(r(i))].push(i.value):s["input:".concat(r(i))].push(i.value):("textarea"===i.nodeName.toLowerCase()||void 0!==i.value)&&s["input:".concat(r(i))].push(i.value));for(var c in s)s[c]&&"function"==typeof s[c].join&&(s[c]=s[c].join(", "))}n.checkConsent("forms")&&n.addHaEvents({key:"formSubmit",segmentation:s})}))}},{key:"getClickElementRelativeCoordinate",value:function(e){return e.offsetX&&e.offsetY?{offsetX:e.offsetX,offsetY:e.offsetY}:{offsetX:0,offsetY:0}}},{key:"getElementPath",value:function(e,t){if(!e)return"";var n=e,r=[],i=[];if(!n)return i.toString();for(;null!=n.parentNode;){for(var o=0,s=0,a=n.parentNode.childNodes.length,c=0;c<a;c+=1){var u=n.parentNode.childNodes[c];if(u.nodeName===n.nodeName&&(o+=1,u===n&&(s=o),s>0&&o>1))break}if((a=""!==n.id)&&t){r.unshift("#".concat(encodeURIComponent(n.id)));break}a&&(a="#".concat(encodeURIComponent(n.id)),a=r.length>0?"".concat(a,">").concat(r.join(">")):a,i.push(a)),r.unshift(encodeURIComponent(String(n.nodeName).toLowerCase())+(o>1?":eq(".concat(s-1,")"):"")),n=n.parentNode}return i.push(r.join(">")),i.toString()}},{key:"collectFromForms",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=function(r){var i,o=Zd(r),s={},a=!1;if(void 0!==o.elements){var c,u,h={},l=e.getElementsByTagName("LABEL");for(c=0;c<l.length;c+=1)l[c].htmlFor&&""!==l[c].htmlFor&&(h[l[c].htmlFor]=l[c].innerText||l[c].textContent||l[c].innerHTML);for(c=0;c<o.elements.length;c+=1)if((i=o.elements[c])&&"password"!==i.type&&-1===i.className.indexOf("ha-user-ignore")){var f="";if("select"===i.nodeName.toLowerCase()?f=void 0!==i.multiple?Bd(i):i.options[i.selectedIndex].value:"input"===i.nodeName.toLowerCase()?void 0!==i.type&&("checkbox"===i.type.toLowerCase()||"radio"===i.type.toLowerCase())?i.checked&&(f=i.value):f=i.value:("textarea"===i.nodeName.toLowerCase()||void 0!==i.value)&&(f=i.value),i.className&&-1!==i.className.indexOf("ha-user-")){var d=i.className.split(" ");for(u=0;u<d.length;u+=1)if(0===d[u].indexOf("ha-user-")){s[d[u].replace("ha-user-","")]=f,a=!0;break}}else i.type&&"email"===i.type.toLowerCase()||i.name&&-1!==i.name.toLowerCase().indexOf("email")||i.id&&-1!==i.id.toLowerCase().indexOf("email")||i.id&&h[i.id]&&-1!==h[i.id].toLowerCase().indexOf("email")||/[^@\s]+@[^@\s]+\.[^@\s]+/.test(f)?(s.email||(s.email=f),a=!0):i.name&&-1!==i.name.toLowerCase().indexOf("username")||i.id&&-1!==i.id.toLowerCase().indexOf("username")||i.id&&h[i.id]&&-1!==h[i.id].toLowerCase().indexOf("username")?(s.username||(s.username=f),a=!0):i.name&&(-1!==i.name.toLowerCase().indexOf("tel")||-1!==i.name.toLowerCase().indexOf("phone")||-1!==i.name.toLowerCase().indexOf("number"))||i.id&&(-1!==i.id.toLowerCase().indexOf("tel")||-1!==i.id.toLowerCase().indexOf("phone")||-1!==i.id.toLowerCase().indexOf("number"))||i.id&&h[i.id]&&(-1!==h[i.id].toLowerCase().indexOf("tel")||-1!==h[i.id].toLowerCase().indexOf("phone")||-1!==h[i.id].toLowerCase().indexOf("number"))?(s.phone||(s.phone=f),a=!0):i.name&&(-1!==i.name.toLowerCase().indexOf("org")||-1!==i.name.toLowerCase().indexOf("company"))||i.id&&(-1!==i.id.toLowerCase().indexOf("org")||-1!==i.id.toLowerCase().indexOf("company"))||i.id&&h[i.id]&&(-1!==h[i.id].toLowerCase().indexOf("org")||-1!==h[i.id].toLowerCase().indexOf("company"))?(s.organization||(s.organization=f),a=!0):(i.name&&-1!==i.name.toLowerCase().indexOf("name")||i.id&&-1!==i.id.toLowerCase().indexOf("name")||i.id&&h[i.id]&&-1!==h[i.id].toLowerCase().indexOf("name"))&&(s.name||(s.name=""),s.name+="".concat(f," "),a=!0)}}a&&(t.log("Gathered user data",s),n?t.userDetails({custom:s}):t.userDetails(s))};Yd(e=e||document,"submit",r)}},{key:"optOut",value:function(){this.log("Opt out"),this.ignoreVisitor=!0,this.store("ha_ignore",!0)}},{key:"optIn",value:function(){this.log("Opt in"),this.store("ha_ignore",!1),this.ignoreVisitor=!1,this.checkIgnore(),this.ignoreVisitor||this.hasPulse||this.heartBeat()}},{key:"onStorageChange",value:function(e,t){switch(e){case"ha_queue":this.requestQueue=this.deserialize(t||"[]");break;case"ha_event":this.eventQueue=this.deserialize(t||"[]");break;case"ha_remote_configs":this.remoteConfigs=this.deserialize(t||"{}");break;case"ha_ignore":this.ignoreVisitor=this.deserialize(t);break;case"ha_id":this.deviceId=this.deserialize(t);break;case"ha_session_id":this.sessionId=this.deserialize(t)}}},{key:"addHaEvents",value:function(e,t){if(!this.ignoreVisitor)if(e.key){var n=Object.create(null);if(t)n=e;else{e.count||(e.count=1);n=Kd(e,["key","count","sum","dur","segmentation","customEventFlag"])}n.timestamp=Xd();var r=new Date;n.hour=r.getHours(),n.dow=r.getDay(),this.eventQueue.push(n),this.store("ha_event",this.eventQueue),this.log("Adding event: ",e)}else this.log("Event must have key property")}},{key:"updateConsent",value:function(){var e=this;this.consentTimer&&(clearTimeout(this.consentTimer),this.consentTimer=null),this.consentTimer=setTimeout((function(){ip(e.syncConsents)&&(e.toRequestQueue({consent:JSON.stringify(e.syncConsents)}),e.syncConsents={})}),1e3)}},{key:"checkIgnore",value:function(){this.ignorePrefetch&&"hidden"===document.visibilityState&&(this.ignoreVisitor=!0),this.ignoreBots&&yp.test(navigator.userAgent)&&(this.ignoreVisitor=!0)}},{key:"notifyLoaders",value:function(){if(void 0!==this.onload&&this.onload.length>0){for(var e=0;e<this.onload.length;e+=1)"function"==typeof this.onload[e]&&this.onload[e](this);this.onload=[]}}},{key:"reportViewDuration",value:function(){var e;if(this.lastView){var t={name:this.lastView,title:this.lastTitle};this.checkConsent("views")&&(t.supportCookie=(null===(e=window.navigator)||void 0===e?void 0:e.cookieEnabled)?"1":"0",this.addHaEvents({key:"view",dur:this.trackTime?Wd()-this.lastViewTime:this.lastViewStoredDuration,segmentation:t})),this.lastView=null}}},{key:"getLastView",value:function(){return this.lastView}},{key:"extendSession",value:function(){if(this.useSessionCookie){if(this.isSessionExpired())return void this.changeSessionId();this.store("ha_session",Wd()+60*this.sessionCookieTimeout)}}},{key:"prepareRequest",value:function(e){e.appKey=this.appKey,e.secretKey=this.secretKey,e.deviceId=this.deviceId,e.sessionId=this.sessionId,e.sdkName="@hi/analytics",e.sdkVersion="1.4.3",e.protocol=window.location.protocol.replace(":",""),e.domain=window.location.hostname,this.checkConsent("location")?(this.countryCode&&(e.countryCode=this.countryCode),this.city&&(e.city=this.city),this.ipAddress&&(e.ipAddress=this.ipAddress)):e.location="";var t=new Date;e.dow=t.getDay(),e.hour=t.getHours(),e.timestamp=Xd()}},{key:"toRequestQueue",value:function(e){this.ignoreVisitor||(this.appKey&&this.deviceId?(this.prepareRequest(e),this.requestQueue.length>this.queueSize&&this.requestQueue.shift(),this.requestQueue.push(e),this.store("ha_queue",this.requestQueue,!0)):this.log("appKey or deviceId is missing"))}},{key:"heartBeat",value:function(){var t=this;if(this.notifyLoaders(),this.testMode||this.ignoreVisitor)this.hasPulse=!1;else{this.hasPulse=!0;var n=0;if(this.global&&void 0!==this.q&&this.q.length>0){var r,i=this.q;for(n=0;n<i.length;n+=1)if(r=i[n],this.log("Processing queued call",r),"function"==typeof r)r();else if(Array.isArray(r)&&r.length>0){var o,s=this,a=this,c=0;if(e.i[r[c]]&&(a=e.i[r[c]],c+=1),"function"==typeof a[r[c]])(o=a)[r[c]].apply(o,ld(r.slice(c+1)));else if(0===r[c].indexOf("userData.")){var u=r[c].replace("userData.","");"function"==typeof a.userData[u]&&a.userData[u].apply(a,r.slice(c+1))}else"function"==typeof s[r[c]]&&s[r[c]].apply(s,ld(r.slice(c+1)))}this.q.splice(0,i.length)}if(this.sessionStarted&&this.autoExtend&&this.trackTime){var h=Wd();h-this.lastBeat>this.sessionUpdate&&(this.sessionDuration(h-this.lastBeat),this.lastBeat=h)}if(this.eventQueue.length>0){if(this.eventQueue.length<=this.maxEventBatch)this.toRequestQueue({events:JSON.stringify(this.eventQueue)}),this.eventQueue=[];else{var l=this.eventQueue.splice(0,this.maxEventBatch);this.toRequestQueue({events:JSON.stringify(l)})}this.store("ha_event",this.eventQueue)}if(!this.offlineMode&&this.requestQueue.length>0&&this.readyToProcess&&Wd()>this.failTimeout){this.readyToProcess=!1;var f=this.requestQueue[0];ip(this.syncConsents)&&(this.consentTimer&&(clearTimeout(this.consentTimer),this.consentTimer=null),f.consent=JSON.stringify(this.syncConsents),this.syncConsents={}),this.log("Processing request",f),this.store("ha_queue",this.requestQueue,!0),this.sendXmlHttpRequest(this.url+this.apiPath,f,(function(e,n){t.log("Request Finished",n,e),e?t.failTimeout=Wd()+t.failTimeoutAmount:t.requestQueue.shift(),t.store("ha_queue",t.requestQueue,!0),t.readyToProcess=!0}))}this.heartBeatTimer&&(clearTimeout(this.heartBeatTimer),this.heartBeatTimer=null),this.heartBeatTimer=setTimeout(this.heartBeat.bind(this),this.beatInterval)}}},{key:"getId",value:function(){return this.store("ha_id")||zd()}},{key:"getSessionId",value:function(){return this.store("ha_session_id")||zd()}},{key:"isUUID",value:function(){return/[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-4[0-9a-fA-F]{3}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}/.test(this.deviceId)}},{key:"getMetrics",value:(t=sd(regeneratorRuntime.mark((function e(){var t,n,r,i,o,s,a,c,u,h;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=JSON.parse(JSON.stringify(this.metrics||{})),e.next=3,p=void 0,(null===navigator||void 0===navigator?void 0:navigator.userAgentData)?null===(p=null===navigator||void 0===navigator?void 0:navigator.userAgentData)||void 0===p?void 0:p.getHighEntropyValues(["platform","platformVersion","uaFullVersion"]):Promise.resolve(!1);case 3:if(n=e.sent,r=rd(rd({},cp()),(l=void 0,f=void 0,d=void 0,f={ie:"",edge:"",firefox:"",opera:"",chrome:"",safari:"",hiklink:""},d=navigator.userAgent.toLowerCase(),l=function(e){var t="Unknown",n={trident:/\b(?:msie |ie |trident\/[0-9].*rv[ :])([0-9.]+)/,webkit:/\bapplewebkit[\/]?([0-9.+]+)/,gecko:/\bgecko\/(\d+)/,presto:/\bpresto\/([0-9.]+)/};for(var r in n)n[r].test(e)&&(t=r);return t}(d),d.match(/rv:([\d.]+)\) like gecko/)?f.ie=(d.match(/rv:([\d.]+)\) like gecko/)||[])[1]:d.match(/msie ([\d.]+)/)?f.ie=(d.match(/msie ([\d.]+)/)||[])[1]:d.match(/edge\/([\d.]+)/)?f.edge=(d.match(/edge\/([\d.]+)/)||[])[1]:d.match(/edg\/([\d.]+)/)?f.edge=(d.match(/edg\/([\d.]+)/)||[])[1]:d.match(/firefox\/([\d.]+)/)?f.firefox=(d.match(/firefox\/([\d.]+)/)||[])[1]:d.match(/(?:opera|opr).([\d.]+)/)?f.opera=(d.match(/(?:opera|opr).([\d.]+)/)||[])[1]:d.match(/chrome\/([\d.]+)/)?f.chrome=(d.match(/chrome\/([\d.]+)/)||[])[1]:d.match(/version\/([\d.]+).*safari/)?f.safari=(d.match(/version\/([\d.]+).*safari/)||[])[1]:d.match(/hiklink/)&&(f.hiklink="HikLink"),f.ie?{browser:"IE",browserVersion:f.ie,kernel:l}:f.edge?{browser:"EDGE",browserVersion:f.edge,kernel:l}:f.firefox?{browser:"Firefox",browserVersion:f.firefox,kernel:l}:f.chrome?{browser:"Chrome",browserVersion:f.chrome,kernel:l}:f.opera?{browser:"Opera",browserVersion:f.opera,kernel:l}:f.safari?{browser:"Safari",browserVersion:f.safari,kernel:l}:f.hiklink?{browser:"HikLink",browserVersion:"",kernel:l}:{browser:"Unknown",browserVersion:"Unknown",kernel:l})),"boolean"!=typeof n&&(r.browserVersion=n.uaFullVersion,"windows"===r.os&&parseInt(n.platformVersion,10)>=13&&(r.osVersion="11")),t.ua=JSON.stringify(r),t.title=document.title,window.screen.width&&(i=window.screen.width?window.screen.width:0,o=window.screen.height?window.screen.height:0,0!==i&&0!==o&&(navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform)&&window.devicePixelRatio?(i=Math.round(i*window.devicePixelRatio),o=Math.round(o*window.devicePixelRatio)):90===Math.abs(Number(window.orientation))&&(s=i,i=o,o=s),t.resolution=t.resolution||"".concat(i,"x").concat(o))),window.devicePixelRatio&&(t.density=t.density||window.devicePixelRatio),void 0!==(a=navigator.language||navigator.browserLanguage||navigator.systemLanguage||navigator.userLanguage)&&(t.locale=t.locale||a),void 0===document.referrer||!document.referrer.length){e.next=34;break}if(!(c=gp.exec(document.referrer))||!c[11]||c[11]===window.location.hostname){e.next=34;break}if(u=!1,!this.ignoreReferrers||!this.ignoreReferrers.length){e.next=33;break}h=0;case 18:if(!(h<this.ignoreReferrers.length)){e.next=33;break}if(e.prev=19,!new RegExp(this.ignoreReferrers[h]).test(document.referrer)){e.next=25;break}return this.log("Ignored:",document.referrer),u=!0,e.abrupt("break",33);case 25:e.next=30;break;case 27:e.prev=27,e.t0=e.catch(19),this.log("Problem with regex",this.ignoreReferrers[h]);case 30:h+=1,e.next=18;break;case 33:u||(t.store=t.store||document.referrer);case 34:return this.log("Got metrics",t),e.abrupt("return",Promise.resolve(t));case 36:case"end":return e.stop()}var l,f,d,p}),e,this,[[19,27]])}))),function(){return t.apply(this,arguments)})},{key:"log",value:function(){if(this.debug&&"undefined"!=typeof console){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t[1]&&"object"===id(t[1])&&(t[1]=JSON.stringify(t[1])),this.global||(t[0]="[".concat(this.appKey,"] ").concat(t[0])),console.log(t.join("\n"))}}},{key:"sendBeacon",value:function(e,t,n){if(navigator.sendBeacon){this.log("Sending beacon");var r=navigator.sendBeacon(e,Jd(t));if("function"==typeof n&&r)return void n()}this.sendXmlHttpRequest(e,t,n)}},{key:"sendXmlHttpRequest",value:function(e,t,n){var r=this;try{this.log("Sending XML HTTP request");var i=window.XMLHttpRequest?new window.XMLHttpRequest:new window.ActiveXObject("Microsoft.XMLHTTP"),o=Jd(t=t||{}),s="GET";for(var a in(this.forcePost||o.length>=2e3)&&(s="POST"),"GET"===s?i.open("GET","".concat(e,"?").concat(o),!0):(i.open("POST",e,!0),i.setRequestHeader("Content-type","application/x-www-form-urlencoded")),this.headers)Object.prototype.hasOwnProperty.call(this.headers,a)&&i.setRequestHeader(a,this.headers[a]);i.onreadystatechange=function(){4===i.readyState&&i.status>=200&&i.status<300?"function"==typeof n&&n(!1,t,i.responseText):4===i.readyState&&(r.log("Failed Server XML HTTP request",i.status),"function"==typeof n&&n(!0,t))},"GET"===s?i.send():i.send(o)}catch(e){this.log("Failed XML HTTP request",e),"function"==typeof n&&n(!0,t)}}},{key:"setToken",value:function(e){this.store("ha_token",e)}},{key:"getToken",value:function(){var e=this.store("ha_token");return this.store("ha_token",null),e}},{key:"getEventQueue",value:function(){return this.eventQueue}},{key:"getRequestQueue",value:function(){return this.requestQueue}},{key:"clearQueue",value:function(){this.requestQueue=[],this.store("ha_queue",[]),this.eventQueue=[],this.store("ha_event",[])}},{key:"store",value:function(e,t,n,r){if("none"===this.storage)return null;var i,o,s=this;function a(e,t,n){var r="";if("number"==typeof n){var i=new Date;i.setTime(i.getTime()+24*n*60*60*1e3),r="; expires=".concat(i.toGMTString())}var o="".concat(e,"=").concat(t).concat(r,"; path=/");s.useLocalStorageCookie?localStorage.setItem(e,o):document.cookie=o}function c(e){for(var t="".concat(e,"="),n=(s.useLocalStorageCookie?localStorage.getItem(e)||"":document.cookie).split(";"),r=0,i=n.length;r<i;r+=1){for(var o=n[r];" "===o.charAt(0);)o=o.substring(1,o.length);if(0===o.indexOf(t))return o.substring(t.length,o.length)}return null}return r||(e="".concat(this.appKey,"/").concat(e),this.namespace&&(e="".concat((i=this.namespace,"/"===i.substr(i.length-1)?i.substr(0,i.length-1):i),"/").concat(e))),n=n||"localstorage"===this.storage,null!=t&&(t=this.serialize(t),this.localStorageSupport?e.indexOf("session")>=0?a(e,t):localStorage.setItem(e,t):n||a(e,t,30)),void 0===t?(this.localStorageSupport?o=e.indexOf("session")>=0?c(e):localStorage.getItem(e):n||(o=c(e)),this.deserialize(o)):(null===t&&(this.localStorageSupport?e.indexOf("session")>=0?a(e,"",-1):localStorage.removeItem(e):n||a(e,"",-1)),null)}},{key:"changeSessionId",value:function(){this.eventQueue.length>0&&(this.toRequestQueue({events:JSON.stringify(this.eventQueue)}),this.eventQueue=[],this.store("ha_event",this.eventQueue)),this.endSession(0,!0),this.timedEvents={};var e=zd();this.store("ha_session_id",e),this.sessionId=e,this.log("SessionId",this.sessionId),this.beginSession(!0,!0)}},{key:"checkEnable",value:function(e){try{var t=window.XMLHttpRequest?new window.XMLHttpRequest:new window.ActiveXObject("Microsoft.XMLHTTP");t.open("GET","".concat(this.url,"/enable?appKey=").concat(this.appKey),!0),t.setRequestHeader("Content-type","application/x-www-form-urlencoded"),t.onreadystatechange=function(){if(4===t.readyState&&t.status>=200&&t.status<300){var n=JSON.parse(t.responseText);"function"==typeof e&&e(n)}},t.send()}catch(e){this.log("Failed XML HTTP request",e)}}},{key:"requestEvent",value:function(e){e.customEventFlag=!0;var t=rd(rd({},e),{},{requestInfo:rd(rd({},e.requestInfo),{},{view:this.getViewUrl()})});if(!this.ignoreVisitor)if(t.key){if(t.count||(e.count=1),this.checkConsent("events")){var n=Kd(t,["key","count","sum","dur","requestInfo"]),r=new Date;n.timestamp=Xd(),n.hour=r.getHours(),n.dow=r.getDay(),this.eventQueue.push(n),this.store("ha_event",this.eventQueue)}}else this.log("Event must have key property")}},{key:"isSessionExpired",value:function(){var e=this.store("ha_session");return!e||parseInt(e,10)<=Wd()}}],[{key:"serialize",value:function(e){return"object"===id(e)&&(e=JSON.stringify(e)),e}},{key:"deserialize",value:function(e){try{e&&(e=JSON.parse(e))}catch(e){}return e}},{key:"getViewName",value:function(){return window.location.hash.indexOf("#/")>=0?window.location.hash.substring(1):window.location.pathname+window.location.search+window.location.hash}},{key:"getViewUrl",value:function(){return window.location.href}}]),e}();if(wp.i={},"undefined"!=typeof window&&void 0!==window.document){var bp=window.HI_ANALYTICS_OBJECT||"ha",kp=window[bp];if(kp&&kp.appKey&&(!wp.i||!wp.i[kp.appKey])){var Ep=new wp(kp);if(!wp.i)for(var Sp in wp.i={},Ep)kp[Sp]=Ep[Sp];wp.i[kp.appKey]=Ep}}return wp}));
