/*! portal-pc-static - git - 2023-03-29 19:12:15 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("@weiyi/bridge")):"function"==typeof define&&define.amd?define(["@weiyi/bridge"],t):(e=e||self,e.monitor=t(e.bridge))}(this,function(e){"use strict";if(e=e&&e.hasOwnProperty("default")?e["default"]:e,"undefined"==typeof $GLog){if("undefined"==typeof GreenLine||!GreenLine.Log)return!1;window.$GLog=GreenLine.Log}var t=function(){return t=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},t.apply(this,arguments)},n={isBrowser:"undefined"!=typeof navigator};n.isBrowser&&(n.supportJsBridge=/MWYS?Browser/.test(navigator.userAgent));var r=1,o=!1,i=function(){o=!0},a=function(){return(new Date).getTime()+"-"+r++},s=function(){for(var e=[],t="0123456789abcdef",n=0;n<36;n++)e[n]=t.substr(Math.floor(16*Math.random()),1);e[14]="4",e[19]=t.substr(3&e[19]|8,1),e[8]=e[13]=e[18]=e[23]="-";var r=e.join("");return r},c=function(){if(window.localStorage){var e=localStorage.getItem("persessionId");if(e)return e;e=Date.now()+s(),localStorage.setItem("persessionId",e)}else{var e=g("persessionId");if(e)return e;e=Date.now()+s(),d("persessionId",e,"Infinity")}return e},u=function(){if(window.localStorage){var e=localStorage.getItem("shortsessionId");if(e)return e;e=(Date.now()+5).toString(),localStorage.setItem("shortsessionId",e)}else{var t=g("shortsessionId");if(t)return t;t=(Date.now()+5).toString(),d("shortsessionId",t,"Infinity")}return t},f=function(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),n=window.location.search.substr(1).match(t);return null!=n?decodeURI(n[2]):""},l=function(e){n.isBrowser&&o&&window.alert(e)},d=function(e,t,n){if("Infinity"===n)var r="expires = Fri, 31 Dec 9999 23:59:59 GMT";else{var o=new Date;o.setTime(o.getTime()+24*n*60*60*1e3);var r="expires="+o.toUTCString()}document.cookie=e+"="+t+"; "+r},g=function(e){var t=document.cookie.match(new RegExp("(^| )"+e+"=([^;]*)(;|$)"))||[];return t[2]?decodeURI(t[2]):""},p=function(e){return function(){return n.isBrowser?void e.apply(null,arguments):console.error("埋点api仅能在浏览器端使用")}},v=function(e,t){void 0===t&&(t="h5");var n="track"+t,r=window.location.hostname.indexOf("guahaoe.com")>-1,o=r?".guahaoe.com/blank.gif":".wedoctor.com/blank.gif";return e?"http://"+n+".guahao-inc.com/blank.gif":"https://"+n+o},m=function(){var e=window.self!==window.top,t=e?document.referrer:"";return t},h=function(e,t){void 0===e&&(e="h5");var n=t?t.replace(/\s/g,""):"unknown";return"web"===e&&n.indexOf(",")===-1&&(n="body,span,"+n),n},w=function(e,t){var n=[];for(var r in e)e.hasOwnProperty(r)&&n.push(r+"="+encodeURIComponent(e[r]));var o=n.join("|"),i="";if(t)try{i=encodeURIComponent(JSON.stringify(t))}catch(a){console.error(a)}return{pdata:o,data:i}},y="mlc",I=function(e,t){var n=e+"&"+JSON.stringify(t);try{sessionStorage.setItem(y,n)}catch(r){console.error(r)}},b=function(){var e="";try{e=sessionStorage.getItem(y)||"",sessionStorage.removeItem(y)}catch(t){console.error(t)}return e.split("&")},S=function(t,r,o,i){return e&&n.supportJsBridge&&!r.disableAppScout?void k(t,r,o,i):void T(t,r,o,i)},_=function(t,r,o,i){return e&&n.supportJsBridge&&!r.disableAppScout?void E(t,r,o,i):void O(t,r,o,i)},k=function(t,n,r,o){var i=t.args,a=t.data,s=b();e.emit("pageTracker",{pageUrl:i&&i.url?i.url:location.href,seq:i.pv_seq||0,msg:a?JSON.stringify(a):null,sourceEvent:s[0]||"",sourceData:s[1]||""},function(){"function"==typeof r&&r(),l("客户端page埋点成功")},function(){T(t,n,r,o),l("客户端page埋点成功")})},E=function(t,n,r,o){var i=t.args,a=t.data;e.emit("actionTracker",{pageUrl:location.href,clickCode:i?i.click_event:"unknown",msg:a?JSON.stringify(a):null},function(){"function"==typeof r&&r(),l("客户端click埋点成功")},function(){O(t,n,r,o),l("客户端click埋点失败")})},T=function(e,t,n,r){var o=t&&t.logUrl?t.logUrl:"https://trackh5.wedoctor.com/blank.gif",i=e.args,a=e.data,s=w(i,a),c=b(),u=o+"?pdata="+s.pdata+"&data="+s.data+"\n  &sourceevent="+(c[0]||"")+"&sourcedata="+(c[1]||"");U(u,n,r)},O=function(e,t,n,r){var o=t&&t.logUrl?t.logUrl:"https://trackh5.wedoctor.com/blank.gif",i=e.args,a=e.data,s=w(i,a),c=o+"?pdata="+s.pdata+"&data="+s.data;U(c,n,r)},U=function(e,t,n){var r=new Image;r.onload=function(){"function"==typeof t&&t(),l("h5埋点成功")},r.onerror=function(){"function"==typeof n&&n(new Error("scout error")),l("h5埋点失败")},r.src=e},x={getItem:function(){try{var e=+localStorage.getItem("monitor_sid");return e>0?+e:0}catch(t){return-1}},setItem:function(e){try{return localStorage.setItem("monitor_sid",e),!0}catch(t){return!1}}},L={getItem:function(){try{var e=+sessionStorage.getItem("monitor_seq");return e>0?e:0}catch(t){return-1}},setItem:function(e){try{return sessionStorage.setItem("monitor_seq",e),!0}catch(t){return!1}}},N=function(){Array.prototype.indexOf||(Array.prototype.indexOf=function(e,t){var n;if(null==this)throw new TypeError('"this" is null or not defined');var r=Object(this),o=r.length>>>0;if(0===o)return-1;var i=+t||0;if(Math.abs(i)===1/0&&(i=0),i>=o)return-1;for(n=Math.max(i>=0?i:o-Math.abs(i),0);n<o;){if(n in r&&r[n]===e)return n;n++}return-1})},D=function(e,t,n){void 0===n&&(n="");var r=0,o=e.length,i=void 0===o||"function"==typeof e;if(n)if(i){for(var a in e)if(t.apply(e[a],n)===!1)break}else for(;r<o&&t.apply(e[r++],n)!==!1;);else if(i){for(var a in e)if(t.call(e[a],a,e[a])===!1)break}else for(;r<o&&t.call(e[r],r,e[r++])!==!1;);return e},q=function(e,t){var n=e.getElementsByTagName("*"),r=[];return n.length&&D(n,function(){this.attributes&&void 0!==this.attributes[t]&&r.push(this)}),r},B=function(e,t,n){(B=e.addEventListener?function(e,t,n){e.addEventListener(t,n,!1)}:function(e,t,n){e.attachEvent("on"+t,n)})(e,t,n)},J=function(e,t,n,r){B(e,n,function(n){var o=q(e,t);n=n?n:window.event;var i=n.srcElement?n.srcElement:n.target;for(console.log("targets",o),console.log("target",i);o.indexOf(i)===-1;){if(!i||!i.nodeName||"HTML"===i.nodeName)return;i=i.parentElement}return r.apply(i,arguments)})},$=function(e,t){e.directive("monitor",function(e,n){try{var r="string"==typeof n.value?{$event:n.value}:JSON.parse(JSON.stringify(n.value)),o=r.$event.trim();if(0===o.length)throw new Error("埋点 $event 不能为空");delete r.$event;var i=function(e){e.stopPropagation(),t.click.bind(t,o,r)()};window.monitorEvents.push(i);var a=window.monitorEvents.length-1;e.setAttribute("onclick","monitorEvents["+a+"](event)")}catch(s){console.log("%c埋点配置错误","font-weight: bold;","\n元素: ",e,"\n值: ",n.value),console.error(s)}})},A=function(e){J(document,"monitor","click",function(){var t=this.getAttribute("monitor"),n={};D(this.attributes,function(e,t){t.nodeName.replace(/monitor-(.*)/,function(e,r){r=r.replace(/-/g,"_"),n[r]=t.nodeValue})}),e.click(t,n)})},M=function(e,t){if("directive"===e.monitorType){if(!e.vue)return void console.error("请传入 vue 示例");window.monitorEvents=[],$(e.vue,t)}else"attribute"===e.monitorType&&(console.log(111),A(t))},P={debug:!1,system:"h5",monitorType:"",vue:null,logUrl:"",disableAppScout:!1,isTrackSinglePage:!1},j="",G={},R={install:function(e,n){var r={pv_sid:x.getItem(),pv_seq:L.getItem(),channel:f("_channel")||"",enc_user_id:g("_monitor_user_id")||"",uuid:c()||"",persession_id:c()||"",shortsession_id:u()||""};if(G=t({},r,e),P=t({},P,n),N(),M(P,R),P.debug&&i(),n&&n.isTrackSinglePage){var o=window.history.replaceState;window.history.replaceState=function(){o.apply(window.history,arguments),C()};var a=window.history.pushState,s=a?"popstate":"hashchange";window.removeEventListener(s,C,!1),window.addEventListener(s,C,!1)}l("初始化成功")},visit:function(e,n,r){G.pv_seq=L.getItem(),0===L.getItem()&&x.setItem(String(Number(x.getItem())+1)),L.setItem(String(Number(L.getItem())+1));var o=18e5;setTimeout(function(){L.setItem("0")},o);var i=t({},G,{report_time:(new Date).getTime(),refer_url:document.referrer||"",url:location.href,unique_id:a(),acct_id:f("_f")||"",iframe_wrapper_url:m(),track_souce:g("_track_source")||""},n),s={logUrl:P.logUrl?P.logUrl:v(P.debug,P.system)};S({args:i,data:e},s,function(){"function"==typeof r&&r(null),l("页面埋点上报成功")},function(){"function"==typeof r&&r(new Error),l("页面埋点上报失败")}),j=location.href},click:function(e,n,r,o){var i=t({},G,{report_time:(new Date).getTime(),url:location.href,unique_id:a(),click_event:h(P.system,e)},r),s={logUrl:P.logUrl?P.logUrl:v(P.debug,P.system)};_({args:i,data:n},s,function(){"function"==typeof o&&o(null),I(e,n),l("点击埋点上报成功")},function(){"function"==typeof o&&o(new Error),l("点击埋点上报失败")})}},C=function(){R.visit(null,{refer_url:j})};for(var F in R)R.hasOwnProperty(F)&&"function"==typeof R[F]&&(R[F]=p(R[F]));var H=R;return window.$TK=window.scout=H,H});