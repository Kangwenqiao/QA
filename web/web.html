<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>智能问诊</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta name="format-detection" content="telephone=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<link rel="stylesheet" href="css.css">
 <link href="css/slick.css" type="text/css" rel="stylesheet" />
    <link href="css/style.css" type="text/css" rel="stylesheet" />
    <link href="css/zy.css" type="text/css" rel="stylesheet" />
    <!--[if IE 8]>
    <script type="text/javascript" src="js/html5shiv.js"></script>
    <![endif]-->
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
	<style>
	.b-b{display: inline-block;vertical-align: top;width: 219px;height: 234px;background-image: url("images/2019/05/zy9.png");transition: background-image .3s;padding-top: 74px;margin: 0 30px;cursor: pointer;}
.b-b:hover{background-image: url("image/zy10.png");}
.b-b:after{content: "";display: block;width: 0;height: 0;background-image: url("image/zy10.png");}
.b-b:hover .b-d{color: #ef8e10;}
	</style>
<script src="https://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
</head>
<body>
<div class="header zy" id="menu"> 
<div class="main zy">
    <div class="a-a">
        <div class="a-banner" id="ad1">
            <div class='a-c'>  <div class='a-d' style='background-image: url(images/2019/05/0e0860424ba94acf829d6521c37a45c8.jpg);'></div>   <div class='a-e'> <div class="a-f">
	
</div>
<br />
<div class="a-g">
	为人们提供优质服务的智能问诊平台
</div></div> </div><div class='a-c'>  <div class='a-d' style='background-image: url(images/2019/05/caa028d4a31a4cc38e14527aec8c7696.jpg);'></div>   <div class='a-e'> <div class="a-f">
	
</div>
<br>
<div class="a-g">
	为人们提供优质服务的智能问诊平台
</div>    </div></div>
            <div class='a-c'>  <div class='a-d' style='background-image: url(images/2019/05/0e0860424ba94acf829d6521c37a45c8.jpg);'></div>   <div class='a-e'> <div class="a-f">
	
</div>
<br/>
<div class="a-g">
	为人们提供优质服务的智能问诊平台
</div></div> </div>
        </div>
    </div>
    <ul class="b-a" id="kuaijierukou">
        <li class='b-b b-b1'>      <a href='web.html'>         <div class='b-c b-c1' style='background-image: url(images/2019/05/3578582d730346cab78cdcae2d0512ee.png);'></div>         <div class='b-c b-c_on b-c1' style='background-image: url(images/2019/05/90eba891eaa243c98c6dd0eb160d74bd.png);'></div>         <div class='b-d'>智能问诊</div>      </a>  </li>        <li class='b-b b-b1'>      <a href='名医推荐.html'>         <div class='b-c b-c1' style='background-image: url("images/2019/05/dcc8c39851bf4575ac524edd93cb3ef1.png");'></div>         <div class='b-c b-c_on b-c1' style='background-image: url("images/2019/05/a993d17c172540c98d05e7ece81f0dea.png");'></div>         <div class='b-d'>专家推荐</div>      </a>  </li>        <li class='b-b b-b1'>      <a href='zhuanxiang1.html'>         <div class='b-c b-c1' style='background-image: url("images/2019/05/30f74502fcae4f1b9c3e4ec94d2cfcf6.png");'></div>         <div class='b-c b-c_on b-c1' style='background-image: url("images/2019/05/f14441ef18d145918077b0c36f507616.png");'></div>         <div class='b-d'>专项普及</div>      </a>  </li>        <li class='b-b b-b1'>      <a href='connect.html'>         <div class='b-c b-c1' style='background-image: url("images/2019/05/fbb77c21795743d4896c2d67a5f74d3a.png");'></div>         <div class='b-c b-c_on b-c1' style='background-image: url("images/2019/05/c485f7482e774978b35860b4a1ced75c.png");'></div>         <div class='b-d'>联系我们</div>      </a>  </li>
    </ul>
    <div class="c-a">
        <div class="c-b">
            <div class="c-c">
                <div class="c-d">智能问诊</div>
                <div class="c-e"><span class="c-f">Intelligent inquiry</span></div>
            </div>
			</div>
	</div>
<div class="dialogue-wrapper">
    <div id="btn_open" class="dialogue-support-btn">
        <i class="dialogue-support-icon"></i>
        <i class="dialogue-support-line"></i>
        <span class="dialogue-support-text">智能问诊</span>
    </div>
    <div class="dialogue-main">
        <div class="dialogue-header">
            <i id="btn_close" class="dialogue-close">></i>
            <div class="dialogue-service-info">
                <i class="dialogue-service-img"></i>
                <div class="dialogue-service-title">
                    <p class="dialogue-service-name">智能问诊机器人</p>
                    
                </div>
            </div>
        </div>
        <div id="dialogue_contain" class="dialogue-contain">
            <p class="dialogue-service-contain"><span class="dialogue-text dialogue-service-text">您好，我是小派，</span></p>
            <!-- <p class="dialogue-customer-contain"><span class="dialogue-text dialogue-customer-text">我有个问题</span></p> -->
        </div>
        <div class="dialogue-submit">
            <p id="dialogue_hint" class="dialogue-hint"><span class="dialogue-hint-icon">!</span><span class="dialogue-hint-text">发送内容不能为空</span></p>
            <textarea id="dialogue_input" class="dialogue-input-text" placeholder="请输入您的问题，按Enter键提交（shift+Enter换行）"></textarea>
            <div class="dialogue-input-tools">

            </div>
        </div>
    </div>
</div>
	</div>
	<div style="height: 600px;">
	</div>
<!--	<div class="footer zy" style="height: 200px; ">-->
	<div class="footer zy">
    <img src="/image/zy29.png" alt="" class="f-c">
    <div class="f-a">
        <div class="f-b">
            <div class="f-d">
            </div>
            <div class="f-o">
                <a href="/web/p_bulletins.html" class="f-p">投资者关系</a>
                <a href="/web/p_social.html" class="f-p">社会责任</a>
                <a href="/web/p_law.html" class="f-p">法律声明和隐私政策</a>
            </div>
            <div class="f-q" id="beian">
                <p>@Copyright 华北水利水电大学&nbsp;&nbsp;|&nbsp;&nbsp;<a href="/sitemap.html">网站地图</a>&nbsp;&nbsp;<a href="/sitemap.xml">XML</a></p>
            </div>
        </div>
    </div>
</div>
<script>
    var doc = document;
    // 模拟一些后端传输数据
    var serviceData = {
        'robot': {
            'name': 'robot001',
            'dialogue': ['模拟回复1', '模拟回复2', '模拟回复3'],
            'welcome': '您好，robot001为您服务'
        }
    };

    var dialogueInput = doc.getElementById('dialogue_input'),
        dialogueContain = doc.getElementById('dialogue_contain'),
        dialogueHint = doc.getElementById('dialogue_hint'),
        btnOpen = doc.getElementById('btn_open'),
        btnClose = doc.getElementById('btn_close'),
        timer,
        timerId,
        shiftKeyOn = false;  // 辅助判断shift键是否按住

    btnOpen.addEventListener('click', function(e) {
        $('.dialogue-support-btn').css({'display': 'none'});
        $('.dialogue-main').css({'display': 'inline-block', 'height': '0'});
        $('.dialogue-main').animate({'height': '600px'})
    })

    btnClose.addEventListener('click', function(e) {
        $('.dialogue-main').animate({'height': '0'}, function() {
            $('.dialogue-main').css({'display': 'none'});
            $('.dialogue-support-btn').css({'display': 'inline-block'});
        });
    })

    dialogueInput.addEventListener('keydown', function(e) {
        var e = e || window.event;
        if (e.keyCode == 16) {
            shiftKeyOn = true;
        }
        if (shiftKeyOn) {
            return true;
        } else if (e.keyCode == 13 && dialogueInput.value == '') {
            // console.log('发送内容不能为空');
            // 多次触发只执行最后一次渐隐
            setTimeout(function() {
                fadeIn(dialogueHint);
                clearTimeout(timerId)
                timer = setTimeout(function() {
                    fadeOut(dialogueHint)
                }, 2000);
            }, 10);
            timerId = timer;
            return true;
        } else if (e.keyCode == 13) {
            var nodeP = doc.createElement('p'),
                nodeSpan = doc.createElement('span');
            nodeP.classList.add('dialogue-customer-contain');
            nodeSpan.classList.add('dialogue-text', 'dialogue-customer-text');
            nodeSpan.innerHTML = dialogueInput.value;
            nodeP.appendChild(nodeSpan);
            dialogueContain.appendChild(nodeP);
            dialogueContain.scrollTop = dialogueContain.scrollHeight;
            submitCustomerText(dialogueInput.value);
        }
    });

    dialogueInput.addEventListener('keyup', function(e) {
        var e = e || window.event;
        if (e.keyCode == 16) {
            shiftKeyOn = false;
            return true;
        }
        if (!shiftKeyOn && e.keyCode == 13) {
            dialogueInput.value = null;
        }
    });

    function submitCustomerText(text) {
        console.log(text)
        // code here 向后端发送text内容
        console.log(serviceData)
        myajax = $.ajax(
            {
                url: 'http://127.0.0.1:5000/index',
                type: 'GET',
                // dataType:'jsonp',
                data: {
                    'sent': text
                },
                success: function(res){
                    console.log(res);
                    console.log(typeof(res));
                    serviceData["robot"]['dialogue'] = JSON.parse(res)['answer']
                    console.log(serviceData)
                },
                error: function(){
				console.log('error')
			}
            }
        )
        $.when(myajax).done(function () {
          console.log(serviceData)
        // 模拟后端回复
        getServiceText(serviceData);
        });

    }

    function getServiceText(data) {
        var serviceText = data.robot.dialogue,
            i = Math.floor(Math.random() * serviceText.length);
        console.log(serviceText)
        var nodeP = doc.createElement('p'),
            nodeSpan = doc.createElement('span');
        nodeP.classList.add('dialogue-service-contain');
        nodeSpan.classList.add('dialogue-text', 'dialogue-service-text');
        nodeSpan.innerHTML = serviceText;
        nodeP.appendChild(nodeSpan);
        dialogueContain.appendChild(nodeP);
        dialogueContain.scrollTop = dialogueContain.scrollHeight;
    }

    // 渐隐
   function fadeOut(obj) {
        var n = 100;
        var time = setInterval(function() {
            if (n > 0) {
                n -= 10;
                obj.style.opacity = '0.' + n;
            } else if (n <= 30) {
                obj.style.opacity = '0';
                clearInterval(time);
            }
        }, 10);
        return true;
    }

    // 渐显
    function fadeIn(obj) {
        var n = 30;
        var time = setInterval(function() {
            if (n < 90) {
                n += 10;
                obj.style.opacity = '0.' + n;
            } else if (n >= 80) {

                obj.style.opacity = '1';
                clearInterval(time);
            }
        }, 100);
        return true;
    }
</script>
<script src="js/jquery.js"></script>
<script src="js/jquery.dotdotdot.min.js"></script>
<script src="js/ie6orie7.js"></script>
<script src="js/slick.js"></script>
<script src="js/placeholder.min.js"></script>
<script src="js/js.js"></script>
<script src="js/zy.js"></script>

<script src="js/num.js"></script>
<script src="js/particles.min.js"></script>
<script src="js/app.js"></script>
<script src="js/my.js"></script>

<script>

    $(function(){

        getTop();//请求头部数据
        getFooter();//请求底部数据

        //设置banner高度
        var ww = $(window).width()
        var hh = $(window).height()
        if(hh/ww<1200/1920){
            $(".a-c").css("height",hh+117)
            $(".a-d").css("height",hh+117)
            $(".a-j").css("height",hh+117)
        }else{
            $(".a-c").css("height",ww*1200/1920)
            $(".a-d").css("height",ww*1200/1920)
            $(".a-j").css("height",ww*1200/1920)
        }
        //轮播
        $('.a-banner').slick({
            dots: true,
            infinite: true,
            speed: 500,
            arrows:false,
            pauseOnHover:false,
            autoplay:true,
            autoplaySpeed:5000
        });
        //解决方案轮播
        $('.c-g').slick({
            infinite: false,
            speed: 500,
            arrows:true,
            pauseOnHover:false,
            autoplay:true,
            autoplaySpeed: 4000,
            draggable:false,
            variableWidth: true,
            // centerMode: true
        });
        var slk = $('.c-g')[0].slick;
        if(slk.slideCount<=3){$(".c-g .slick-arrow").css("display","none");}
        slk.slideCount = slk.slideCount - 2;
        if(slk.slideCount<1){
            //如果小于1就会变竖排了，至少要有1
            slk.slideCount=1
        }
        //资讯轮播
        $('.d-e').slick({
            dots: true,
            infinite: true,
            speed: 500,
            arrows:false,
            pauseOnHover:false,
            autoplay:true,
            autoplaySpeed:5000
        });
        //新闻切换
        $(".d-l").eq(0).addClass("active")
        $(".d-n").eq(0).addClass("show")
        $(".d-l").click(function(){
            $(this).addClass("active").siblings().removeClass("active")
            $(".d-n").removeClass("show").eq($(this).index()).addClass("show")
        })
        //新闻标题多行省略
        $(".d-p").dotdotdot()
        //数字滚动效果
        var hh = $(window).height();
        var bb = $("[dv-num]").eq(0).offset().top;
        $(window).scroll(function(e){
            var a = $(this).scrollTop();
            //滚动到b-a<hh/1.1 && a-b<hh这个范围展示效果
            if(bb-a<hh/1.1 && a-bb<hh){
                $("[dv-num]").each(function(index,item){
                    var ele = $(this)
                    var lay = ele.index()/10 + "s"
                    var numtext = $(this).attr("dv-num")
                    var n = numtext.length
                    var num = parseInt(numtext);
                    ele.rollNumDaq({
                        deVal:num,
                        digit:n
                    })
                })
            }
        })
        $(".e-k").eq(0).addClass("hover")
        $(".e-k").mouseover(function(){
            $(this).addClass("hover").siblings().removeClass("hover")
        })



    
        for(var k in json){
            var sel = '<a class="g-k g-k'+json[k].id+'" key="k'+json[k].id+'" href="'+json[k].url+'"><div class="g-l">'+json[k].a+'</div></a>';
            $(sel).appendTo(".g-list");
        }
        $(".g-k").mouseover(function(){
            $(this).addClass("active").siblings().removeClass("active")
            var key = $(this).attr("key")
            var v = json[key]
            $(".g-f").text(v.b)
            $(".g-j1").text(v.c)
            $(".g-j2").text(v.d)
        })
        $(".g-k").eq(16).trigger("mouseover")
        $("video").each(function(){
            $(this)[0].play()
        })

    })
    function formatDate1(now) {
        var year=now.getFullYear();

        var month=now.getMonth()+1;
        var date=now.getDate();
        return year+"."+month+"."+date+"";
    }
</script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?9301b9190ca9e934bbf582f02d59a623";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>
</body>
</html>